<!DOCTYPE html>
<html>
	

<head>
	<title>Mark S. Rasmussen</title>
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
	<meta charset="UTF-8" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="website" />
	<meta name="google-site-verification" content="alt7-wfK3ZujMQ4D0jYNd0yC5LGetGdqBlBmZsqQlVw" />
	<link rel="alternative" href="http://feeds.feedburner.com/Improvedk" title="Mark S. Rasmussen" type="application/atom+xml">
	<script src="/js/combined.js"></script>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-2479580-1', 'improve.dk');
		ga('send', 	'pageview');
	</script>
	<link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
	<body>
		<div id="headerline"></div>
	
		<header>
			<div class="wrapper">
				<div id="title">
					<a href="/">Mark S. Rasmussen</a> <span>improve.dk</span>
				</div>
				
				<nav>
					<ul class="normal">
						<li class="navicon"><img src="/img/navicon.png" /></li>
						<li><a href="/about-me/">About Me</a></li>
					</ul>
				</nav>
				
				<ul id="sharing">
					<li><a href="mailto:mark@improve.dk"><img src="/img/at.png" /></a></li>
					<li><a href="http://feeds.feedburner.com/Improvedk" id="rssfeed"><img src="/img/rss.png" /></a></li>
					<li><a href="https://twitter.com/improvedk"><img src="/img/twitter.png" /></a></li>
					<li><a href="https://github.com/improvedk"><img src="/img/github.png" /></a></li>
					<li><a href="https://www.linkedin.com/in/markrasmussen/"><img src="/img/linkedin.png" /></a></li>
				</ul>

				<div class="clear"></div>
				
				<div id="naviconcontent">
					<ul class="mobile">
						<li>
							Pages
							<ul class="pages"></ul>
						</li>
						<li>
							Categories
							<ul class="categories"></ul>
						</li>
						<li>
							Archive
							<ul class="archive"></ul>
						</li>
					</ul>
				</div>
			</div>
		</header>

		<div id="mainwrapper">
			<div id="contentwrapper">
				<div id="content">
				
					
	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Jan</span>
			<span class="day">23</span>
		</div>
		<div class="lower">2007</div>
	</div>

	<div class="title">
		<h1><a href="/one-mans-sin-another-mans-blessing/" title="One Mans Sin, Another Mans Blessing" rel="bookmark">One Mans Sin, Another Mans Blessing</a></h1>
		<div class="categories">
			
				<a href="/category/Windows/">Windows</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>This is a reply to the <a href="http://www.intelliadmin.com/blog/2007/01/5-sins-of-vista.html" target="_blank">Top 5 sins of Vista</a> blog post written by Steve Wiseman.</p>
<a id="more"></a>

<h2 id="Number_1_-_The_new_file_browsing_interface_is_different">Number 1 - The new file browsing interface is different</h2>
<p>Yes, Notepad’s great, we all use it, whether we want to admit or not. The file browsing interface however, is also great. That is, if you’re willing to acknowledge it!</p>
<div class="imgwrapper" style=""><div><a href="/one-mans-sin-another-mans-blessing/filebrowsing_2.jpg" class="fancy"><img src="/one-mans-sin-another-mans-blessing/filebrowsing_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Admitted, there’s no reason for the web site addresses to figure in the drop down. But why use the drop down at all? Haven’t you noticed the button on the bottom left hand side, cleverly called, “Folders”? Click this and you’ll see the usual tree view of folders that you seem to miss so much. Keep in mind that this file browsing interface is in every new Vista aware application - including the tree view.</p>
<h2 id="Number_2_-_The_new_start_menu_rocks_(kinda)">Number 2 - The new start menu rocks (kinda)</h2>
<p>I think we can all agree that the new almost instantanious application search feature of the start menu is just great! You however, as I, would like to open various folders in an easy way as we used to. You say you used to click the start menu, click Run, type in the location and click enter. I however, do not believe you. You seem like someone who knows the system better than the average person.</p>
<div class="imgwrapper" style=""><div><a href="/one-mans-sin-another-mans-blessing/rundialog_2.jpg" class="fancy"><img src="/one-mans-sin-another-mans-blessing/rundialog_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Surely you know of the Windows key + R key combination that opens the Run dialog - as it also does on Vista. Pressing Winkey+R gives the run dialog in which you can type “C:” and have that drive open up for you. Much faster than going through the start menu in any way.</p>
<h2 id="Number_3_-_Windows_networking_is_a_bless(ing)">Number 3 - Windows networking is a bless(ing)</h2>
<p>When I first started up Vista and went into the network configuration, oh boy was I disappointed. I had more or less the same feelings as you describe. Luckily for me I was able to accept that Vista is an all new milestone compared to XP. Are Microsoft not allowed to change something that was - admittedly - working before? Having used Vista for no more than a week, surely you’ll have gotten used to the new way of browsing the networks as well as the network configuration. “If you have never used Vista before - Quickly tell me how to change the IP address on my wireless card!”. Now, how in gods name can you expect anyone who has never used a system to be able to tell you this? Were you instantly able to change the IP address of a network adapter the very first time you launched Windows 2000, XP?</p>
<div class="imgwrapper" style=""><div><a href="/one-mans-sin-another-mans-blessing/networkconnections_2.jpg" class="fancy"><img src="/one-mans-sin-another-mans-blessing/networkconnections_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Simply click “Manage network connections” from the tasks section of the menu and we’re back to the good old interface. It really isn’t that cumbersome.</p>
<h2 id="Number_4_-_Windows_Search_is_as_broken_as_it_has_always_been">Number 4 - Windows Search is as broken as it has always been</h2>
<p>Windows Search is not broken. It actually works. Have you tried it? Ok, so you can’t do a content based search on unknown file types, but have you ever been able to do so using Windows Search? You can however easily search through your email, documents, file name based search and so forth.</p>
<div class="imgwrapper" style=""><div><a href="/one-mans-sin-another-mans-blessing/vistasearch_2.jpg" class="fancy"><img src="/one-mans-sin-another-mans-blessing/vistasearch_2.jpg" style="max-height: 250px"/></a></div></div>

<p><em>Please</em>, please, please don’t tell me that a command prompt wildcard directory search enables you to do content based searches. Click the Location:Everywhere item and you’re all set for directory searches as we used to in XP.</p>
<h2 id="Number_5_-_Windows_copying_has_improved">Number 5 - Windows copying has improved</h2>
<p>Given the title of my website I should know what the word “improve” means. To improve something requires that you change something for the better. To improve something you must not make it worse than before. “Sure they have made the interface look cooler, a snazzy progress bar here and there.” You don’t call this an improvement? Sure, it’s not the robust search that you’re looking for, but honestly, isn’t it an improvement? I would really like to have seen the WinFS file system to have been a part of Vista. But surely, even though WinFS did not make it to Vista, I’ll not go as far as saying that Vista is not an improvement over XP. Explorer still has the old bugs, especially in regards of network sharing (shame on you Microsoft!), but still, you cannot say that it has not been <em>improved</em>.</p>
<div class="imgwrapper" style=""><div><a href="/one-mans-sin-another-mans-blessing/filecopy_2.jpg" class="fancy"><img src="/one-mans-sin-another-mans-blessing/filecopy_2.jpg" style="max-height: 250px"/></a></div></div>

<p>I for one, love the fact that we can now see the transfer speed during transfers, even during network transfers!</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Jan</span>
			<span class="day">12</span>
		</div>
		<div class="lower">2007</div>
	</div>

	<div class="title">
		<h1><a href="/playing-at-caesars-palace/" title="Playing at Caesars Palace" rel="bookmark">Playing at Caesars Palace</a></h1>
		<div class="categories">
			
				<a href="/category/Poker/">Poker</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>One of the few places left that I haven’t played at is Caesars Palace. Fortunately I can now cross Caesars off my list.</p>
<a id="more"></a>

<p>The room is separated from the usual casino area by a small walkway. This separation ensures that the room is very quiet, in contrast to the extremely noisy MGM Grand room. The chairs are great swiveling office chairs, quite comfortable. The felt is absolutely perfect, just the way I want it, just the way the Venetian has it - though it seems to be somewhat older at Caesars.</p>
<p>While the Venetian usually has one or two regulars and then drunks or new players for the rest, Caesars seemed to be dominated by regulars and nits. There were a couple of exec guys coming from the CES, but other than that people knew what they were doing, even at the $1/2 level.</p>
<p>Talking about 1/2. Caesars has an absolutely great structure for the 1/2 game, allowing you to buyin for $500, that’s 250BBs! That makes for some great deepstacked play. And while the max buyin is at $500, most people bought in for $1-200, that means you’ll have everybody covered from the getgo, another advantage.</p>
<p>All in all I’ll certainly be back. Caesars is great, but it still won’t be able to change my mind, The Venetian is without doubt the greatest poker room on the strip so far.</p>
<p>Now I just have to cross out Bellagio and Wynn from my list…</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Jan</span>
			<span class="day">09</span>
		</div>
		<div class="lower">2007</div>
	</div>

	<div class="title">
		<h1><a href="/day-1/" title="Day 1" rel="bookmark">Day 1</a></h1>
		<div class="categories">
			
				<a href="/category/Poker/">Poker</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>Since I woke up at 6 AM this morning I decided to just stay in bed and watch The Prestige through the hotel movie system.</p>
<a id="more"></a>

<p>When I got up I realized that the only power adaptor that I’d brought was a US - EU style, not the required EU - US… Friggin typical! So I went to every Futurama fans favorite electronics store, Fry’s Electronics, which is also the largest electronics store in Vegas!</p>
<p>I’ve always spoken badly of the Zune on absolutely no grounds other than my own prediction of it’s success. However, when I came by a stand of Zune’s I simply couldn’t resist buying one, not really because of it’s looks (I think it feels far too like plastic, it just doesn’t have the same iPod quality feel), but because… Well, I dunno, I bought one, that’s what matters.</p>
<p>This is what met me when I started up the Zune for the very first time:</p>
<div class="imgwrapper" style=""><div><a href="/day-1/zune1_2.jpg" class="fancy"><img src="/day-1/zune1_2.jpg" style="max-height: 250px"/></a></div></div>

<p>iPod 1 - 0 Zune</p>
<p>A bit later I went to the Venetian to get my first poker session. A couple of hours went by, nothing in particular to report, I ended about even in the $1/2 game.</p>
<p>I met up with Nicholai from work later on and got a couple Gin &amp; Tonics as well as enjoying the Mandalay Bay buffet. I think we walked about Mandalay Bay for an hour or so before giving up on finding the supposedly impressing pool.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Jan</span>
			<span class="day">09</span>
		</div>
		<div class="lower">2007</div>
	</div>

	<div class="title">
		<h1><a href="/royal-flush-baby/" title="Royal Flush Baby!" rel="bookmark">Royal Flush Baby!</a></h1>
		<div class="categories">
			
				<a href="/category/Poker/">Poker</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>I wanted to log a lot of poker playing hours today. At about 12 PM I went to the MGM Grand, a room that I’d never visited. After playing there for about 5-6 hours (please don’t ask how it went, I got butchered), I’ve got mixed feelings about the room.</p>
<a id="more"></a>

<p>The cocktail service is absolutely great. Although they’re not the lookers as they are at the Wynn, they’re among the quickest on the strip. There’s allways a cocektail waitress around, ready to take your order. The tables are among the most sophisticated ones I’ve seen. Naturally they have automatic shufflers, but most casinos have that these days. Registration of player cards it done automatically at the table itself, no need for a floor to bring it to the cage. Also, the dealer is able to call for cocktail waitresses and chiprunners by pressing buttons on the dealer tray, very efficient! I hate the felt they use, it’s the hard stiff kind you’ll also find at casinos like Royal in Århus, totally impossible to get your fingers beneath the cards to flip’em up or just to take a look at them. It is however rectified by the marble border around the table, creating a litthe gap in the felt, making it easier to get ones finger under the cards. The MGM seemed to have a <em>lot</em> of totally new players, player who’ve never sat in a live game. It’s probably due to the fact that the MGM poker room is placed in the middle of everything, right next to the lion cave and the night club, effectively causing a lot of people to wander by. That also has the effect of causing a ridicilous amount of railbirds as well as contributing to making the room intolerably noisy.</p>
<p>As I had a dinner appointment at the Venetian in the evening, I went to the Venetian at about 6 PM to continue my play. While I was being butchered at the MGM, I made a slaughter at the Venetian game, ending up quite a bit. I’d established quite a loose image at the table, just the way I want it. I was dealt <strong>T</strong>c<strong>Jc</strong>. The flop came <strong>A</strong>c<strong>K</strong>c<strong>8c</strong>. Although I can’t really remember the action, I bet on the flop, got called by a single guy at the end of the table. A blank hit the turn which we both checked. Finally at the river, <strong>Qc</strong>, I bet out about half the pot. It was not until then I realized that I’d just made a Royal Flush! The other guy eventually folded. I showed my cards, saying, “I think I had you”. The table went crazy, so did the dealer and the floor person. Through December they’ve had a Royal Flush promotion that resulted in you winning Venetian jacket if you hit the Royal Flush. Although the promotion weren’t running anymore, Nate, the floor person on duty told me to come back one of the following days and look him up, he’d find a little something for me, great service. To make matters even more special, in the hand right after my Royal Flush I hid a set of threes that quadded on the river, consecutive Royal Flush and quads, what are the odds? Please don’t tell me live games aren’t rigged as well as online games!</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Jan</span>
			<span class="day">09</span>
		</div>
		<div class="lower">2007</div>
	</div>

	<div class="title">
		<h1><a href="/arriving-in-vegas/" title="Arriving in Vegas" rel="bookmark">Arriving in Vegas</a></h1>
		<div class="categories">
			
				<a href="/category/Poker/">Poker</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>Honeeey, I’m home!</p>
<p>It’s good to be back. After all, it’s been about 4 months since I were here last, that’s simply too long time!</p>
<a id="more"></a>

<p>The flight went pretty well. On the long route, Frankfurt - Denver I sat in front a some american family. It was really obvious that they were american, the whole way they talked, acted and so forth, hard to explain, but they where soo stereotypical. Anyways, shortly after taking off, somebody sneezed nearby… “Bless you” the woman behind me almost screamed. Oh well, whatever. Five minutes later somebody else sneezed - bless you! Now, this started to get a bit awkward when somebody in business class, separated by a curtain from where we were sitting, sneezed. Bless you she screamed again, though it was absolutely certain that this guy could not hear her. Making a long story short, besides the few times she slept, everytime someone sneezed, no matter how far away they were, she simply HAD to bless that person.</p>
<p>When we were about to land in Denver, appx 10 feet above the ground, suddenly the plane thrusted upwards at maximum thrust, we had to do a goaround, apparently there’d been a major gust of wind, blowing us off the runway. As a result we got in about 20 minutes late, not really the best of timing since my Las Vegas flight departed just an hour and a half later. Ever since 9/11 the security checks have been insane in the US airports, and Denver is no exception. I had to wait 30 minutes in line for the customs inspection, fortunately this time there were no <a href="http://www.improve.dk/blog/2006/07/26/arrivalatvegas" target="_blank">problems</a>. After the customs check I had to get my bags from the conveyor belts before I could recheck them for my domestic United flight, again, taking about 30 minutes in line. Everything’s a caos since the airports aren’t equipped to these extra checkins that have taken place since 9/11. After being checked in, another 30 minutes of wait before arriving at the front of the security inspection line. At this point there were 10 minutes till my flight departed - not until it boarded, until it departed. Luckily the woman checking my boarding pass noticed and put me through to another line that was somewhat shorter, phew - at least so I thought. After being sprayed with air in some kind of drug sniffing machine the security guard said to another guard: “Give this one the full quarter pounder”. With 5 minutes to go I had to unpack my whole bag, letting him check my camera, cell phone, laptop and everything. I politely asked him how long it would take to get to my gate as my plane left in 2 minues - luckily he understood what I meant and made a quick inspection before letting me go. Running to the gate I arrived 5 minutes late, but fortunately the plane hadn’t left yet, I made it a minute or so before the gate closed.</p>
<div class="imgwrapper" style=""><div><a href="/arriving-in-vegas/ces01_2.jpg" class="fancy"><img src="/arriving-in-vegas/ces01_2.jpg" style="max-height: 250px"/></a></div></div>

<div class="imgwrapper" style=""><div><a href="/arriving-in-vegas/ces02_2.jpg" class="fancy"><img src="/arriving-in-vegas/ces02_2.jpg" style="max-height: 250px"/></a></div></div>

<div class="imgwrapper" style=""><div><a href="/arriving-in-vegas/ces03_2.jpg" class="fancy"><img src="/arriving-in-vegas/ces03_2.jpg" style="max-height: 250px"/></a></div></div>

<div class="imgwrapper" style=""><div><a href="/arriving-in-vegas/ces04_2.jpg" class="fancy"><img src="/arriving-in-vegas/ces04_2.jpg" style="max-height: 250px"/></a></div></div>

<div class="imgwrapper" style=""><div><a href="/arriving-in-vegas/ces05_2.jpg" class="fancy"><img src="/arriving-in-vegas/ces05_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Originally I’d planned to take a hot tub bath before heading into town. I arrived at my hotel at around 8:30 PM. Before I realized it, I was sleeping at the couch, and at 10 PM I had to retire to bed, totally exhausted after the trip.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">31</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/going-to-vegas-again/" title="Going to Vegas (Again)" rel="bookmark">Going to Vegas (Again)</a></h1>
		<div class="categories">
			
				<a href="/category/Poker/">Poker</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>Ahh, Vegas, I just can’t get enough of that place!</p>
<a id="more"></a>

<p>I’m leaving for Vegas again on the 6th of January, planning to be back on the 16th of Janaury. Just a short trip to cope with my dependance on the greatest town in the world!</p>
<p>I will be participating in the <a href="http://www.cesweb.org/default.asp" target="_blank">2007 Internal CES</a> as well as hopefully being able to get a spot at the Venetian Palazzo Ballrom on the 7th when <a href="http://www.cesweb.org/attendees/conferences/keynotes.asp" target="_blank">Bill Gates himself holds a Pre-show Keynote Address</a>.</p>
<p>Also I’d be rather surprised of myself if I didn’t pay some of the greatest poker rooms of Vegas a revisit :)</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">27</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/the-internals-of-spam-mails-part-one/" title="The Internals of Spam Mails - Part 1" rel="bookmark">The Internals of Spam Mails - Part 1</a></h1>
		<div class="categories">
			
				<a href="/category/Miscellaneous/">Miscellaneous</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>Is your name William? Do you normally write mails with the subject “Re: hi”? Are your mails usually 11,304 characters in length? Guess what, you’re a spammer! I present to you, an article containing a textual analysis of about 15,000 spam mails.</p>
<a id="more"></a>

<p>Before you ask, what can these numbers be used for? Good question, I’m open to suggestions!</p>
<p>The following numbers are based on 15,073 spam mails in total. Naturally demographics will play a part, such as my interests, part of the world and so forth. Let me give you the 5 word tour of myself: Denmark, male, 21, development, poker.</p>
<h2 id="Importance">Importance</h2>
<p>All mails can be marked with an importance flag ranging from low to high through normal. I’d think spammers would consider their mails rather important, guess not.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam1_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam1_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Body_format">Body format</h2>
<p>Most anti spam applications today are extra sensitive towards HTML mails so it’s no big surprise that they’re not that common.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam2_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam2_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Number_of_recipients">Number of recipients</h2>
<p>A lot of mail servers as well as anti spam clients will filter out mass mailed emails, that is, emails that have a lot of recipients. Some mails will figure as having zero recipients, these may be caused by bad header formats / values in the mail.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam3_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam3_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Reply-to_field_usage">Reply-to field usage</h2>
<p>The reply-to field enables you to specify an email address used for replies other than the one that was used to send the email with. How many mails utilize this field? (0 = not used, 1 = used)</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam4_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam4_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Mail_size">Mail size</h2>
<p>Don’t you just hate it when you startup Outlook and you have to wait for ages due to several terabytes of spam mails waiting to be downloaded? But how many bytes does an average mail actually take up?</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam5_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam5_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Mail_lengths">Mail lengths</h2>
<p>How long is the average spam mail? The more text, the less chance one will actually read it, right? As for the subject (in number of characters):</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam6_211.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam6_211.jpg" style="max-height: 250px"/></a></div></div>

<p>Note that the 255 upper limit is usually caused by either the mail servers or the mail clients capping the subject at 255 characters. As for the body:</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam7_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam7_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Spammer_names">Spammer names</h2>
<p>What’s William and Richard got to do with each other? They both send a major junkload of spam.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam8_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam8_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Subjects">Subjects</h2>
<p>I’m quite surprised that Viagra is not even in the top 10 subjects, almost disappointed.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam9_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam9_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Common_body_words">Common body words</h2>
<p>What’s the number one used word in the body of spam mails? Pretty boring: “the”.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam10_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam10_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Unusual_body_words">Unusual body words</h2>
<p>I’ve defined an unusual word as one that’s not among the top 300 most common english words - according to: <a href="http://www.esldesk.com/esl-quizzes/most-used-english-words/words.htm" target="_blank">http://www.esldesk.com/esl-quizzes/most-used-english-words/words.htm</a>.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam11_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam11_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Common_subject_words">Common subject words</h2>
<p>How about the subject?</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam12_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam12_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Unusual_subject_words">Unusual subject words</h2>
<p>Same definition as for the unusual body words, this time in regards of the subject.</p>
<div class="imgwrapper" style=""><div><a href="/the-internals-of-spam-mails-part-one/spam13_2.jpg" class="fancy"><img src="/the-internals-of-spam-mails-part-one/spam13_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Common_sentences">Common sentences</h2>
<p>Trying to make any sense out of a common spam mail is not an easy task. Hence the following top 20 common sentences may not make a whole lot of sense either.</p>
<p>Count: <strong>494</strong><br>The attention to detail is paramount and they are comparable to the originals in every way.</p>
<p>Count: <strong>481</strong><br>Having had this same model for several years i was hesitant to spend the money again.</p>
<p>Count: <strong>481</strong><br>You will be very impressed with the quality.</p>
<p>Count: <strong>475</strong><br>Lange sohne glashute original audemars piguet jaeger-lecoultre officine panerai alain silbersteini got my watch yesterday and love it.</p>
<p>Count: <strong>464</strong><br>Replicated to the smallest detail 98 a accuracy includes all proper markings wide selection and fast worldwide shipping authentic weight true-to-original self winding and quartz mechanismsour faithful duplications include these prestige brands rolex mens rolex ladys rolex boys watch box sets patek philippe iwc cartier bvlgari frank muller breitling omega tag heuer chopard vacheron constantin a.</p>
<p>Count: <strong>344</strong><br>Comprestige replicasregards-mens and ladies prestige watches for all occasionsthese replicas have all the presence and poise of the originals after whome they were designed at a fraction of the cost.</p>
<p>Count: <strong>168</strong><br>General fewer your on can try answers for expert help with search.</p>
<p>Count: <strong>135</strong><br>The only way to solve it is to take viagra or cialis super viagra medications before you have sex.</p>
<p>Count: <strong>135</strong><br>You can spend thousands and buy them at your local drug store.</p>
<p>Count: <strong>134</strong><br>03 this problem is called erectile dysfunctioned.</p>
<p>Count: <strong>132</strong><br>Globally the potential market is a staggering 45 billion.</p>
<p>Count: <strong>132</strong><br>Video streams to wherever you choose to watch it.</p>
<p>Count: <strong>105</strong><br>20as the population ages the economic value in the us market for adult daycare is projected to grow nearly 600.</p>
<p>Count: <strong>95</strong><br>Major discoveries are happening all the time and wbrs is in the thick of it.</p>
<p>Count: <strong>95</strong><br>With the array of drilling projects wild brush has going on at the moment tension is building.</p>
<p>Count: <strong>95</strong><br>As the drilling gets closer to completion insiders are accumulating ahead of that major discovery announcement.</p>
<p>Count: <strong>94</strong><br>Get the latest messages emailed to alerts.</p>
<p>Count: <strong>94</strong><br>All we can say is that this one is going to see amazing appreciation in a very short period of time this is your opportunity.</p>
<p>Count: <strong>90</strong><br>You have seen it on 60 minutes and read the bbc news report — now find out just what everyone is talking about.</p>
<p>Count: <strong>90</strong><br>Suppress your appetite and feel full and satisfied all day long increase your energy levels lose excess weight increase your metabolism burn body fat burn calories attack obesity and more.</p>
<h2 id="To_be_continued…">To be continued…</h2>
<p>That’s all for part 1. Hopefully I’ll have come up with some more interesting analysis for the next part :) Feel free to post a suggestion if there’s something specific you’d like to see some numbers of. Also, if you have access to large quantities of spam mail (no, not in the form of signing me up for billions of sites) in Outlook PST format, please de send me a message, I’d really like to have a larger sample to base my analysis upon.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">26</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/executing-assembly-dynamically-in-a-strongly-typed-way/" title="Executing Assembly Dynamically In a Strongly Typed Way" rel="bookmark">Executing Assembly Dynamically In a Strongly Typed Way</a></h1>
		<div class="categories">
			
				<a href="/category/.NET/">.NET</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>During a recent plugin based project that I worked upon, I had to dynamically load assemblies and instantiate objects from those assemblies. Usually that’d require a lot of typecasting and nasty code, but thanks to generics we can make it a lot smoother.</p>
<a id="more"></a>

<p>I present to you my LoadPlugin function of my PluginHandler module:</p>
<figure class="highlight csharp"><pre><span class="keyword">using</span> System.Reflection;
<span class="keyword">using</span> System;

namespace MTH.Core
{
	<span class="keyword">internal</span> <span class="keyword">class</span> PluginHandler
	{
		<span class="keyword">public</span> <span class="keyword">static</span> T LoadPlugin&lt;T&gt;(<span class="keyword">string</span> file)
		{
			Assembly ass = Assembly.LoadFile(file);

			<span class="keyword">foreach</span> (Type t <span class="keyword">in</span> ass.GetTypes())
				<span class="keyword">if</span> (<span class="keyword">typeof</span>(T).IsAssignableFrom(t))
					<span class="keyword">return</span> (T)ass.CreateInstance(t.FullName);

			<span class="keyword">return</span> <span class="keyword">default</span>(T);
		}
	}
}
</pre></figure>

<p>The generic parameter defines the type that should be created from the specified assembly file, this also means that the function will return a strongly typed result of this specific type.</p>
<p>Inside the function we load the assembly and load through each type it hosts. For each type we check the IsAssignableFrom function which’ll check if the current type is of the specified type T, no matter if T is an abstract class, interface or any other type. If it matches, we return a new instance of that type. If no type match is found we return null so we can handle the problem in the calling function.</p>
<p>Note that this is a very simple example function, there are many unhandled parameters! Security for instance. In most scenarios you would probably want to check the identity of the loaded assembly and set the security permissions dependingly. Also it is not possible to pass constructor parameters, this would require an extension of the function to take in an array of objects as constructor parameters.</p>
<p>This is how easily we can load any number of plugins that have been placed in a certain plugin directory (in this case the plugins contains code that is to be run on application startup):</p>
<figure class="highlight csharp"><pre><span class="keyword">foreach</span> (<span class="keyword">string</span> file <span class="keyword">in</span> Directory.GetFiles(Application.StartupPath + <span class="string">"\Plugins\Startup"</span>, <span class="string">"*.dll"</span>))
{
	IRunnable startupPlugin = PluginHandler.LoadPlugin&lt;IRunnable&gt;(file);

	<span class="keyword">if</span> (startupPlugin != <span class="keyword">null</span>)
		startupPlugin.Run();
}
</pre></figure>

<p>All that is required is that the assemblies in the PluginsStartup folder contain a type that implements the IRunnable interface:</p>
<figure class="highlight csharp"><pre>
<span class="keyword">public</span> <span class="keyword">interface</span> IRunnable
{
	<span class="keyword">void</span> Run();
}
</pre></figure>



				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">16</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/creating-a-short-link-internet-explorer-addin/" title="Creating a &quot;Shorten Link&quot; Internet Explorer Addin" rel="bookmark">Creating a &quot;Shorten Link&quot; Internet Explorer Addin</a></h1>
		<div class="categories">
			
				<a href="/category/.NET/">.NET</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>You probably already know of the short link services that are around, <a href="http://makeashorterlink.com/index.php" target="_blank">www.makeashorterlink.com</a> for instance. While the idea behind these sites are indeed good, I personally find it quite cumbersome to actually create the short links when I’m typing a forum post somewhere. In this post I’ll give an example of a short link system that enables one to easily create short links while typing in Internet Explorer, using an Internet Explorer addon that conveniently places itself in the context menu whenever we right click on some text and a .NET webservice that handles the short link functionality.</p>
<a id="more"></a>

<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink1_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink1_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="What’s_a_short_link?">What’s a short link?</h2>
<p>I’ll keep this part short (pun intended). Often when writing in forums, emails, newsgroups and so forth, we need to post links. The problem arises when we have to post a link like this: <a href="http://www.experts-exchange.com/Programming/Programming_Languages/C_Sharp/Q_20801558.html" target="_blank">http://www.experts-exchange.com/Programming/Programming_Languages/C_Sharp/Q_20801558.html</a>, it’s quite large! This may easily ruin the desing of the website and annoy people as it takes up a lot of space. A short link equivalence is: <a href="http://link.improve.dk/8" target="_blank">http://link.improve.dk/8</a>.</p>
<h2 id="The_idea">The idea</h2>
<p>So how can we make it more convenient, so we won’t have to open up a new browser, go to the short link website, create the short link and copy it back into the other browser window? My proposal is that we create an Internet Explorer addin for the context menu like shown in the picture above. That means we can simply type the long url as normally, select it and the right click and select “Replace with short link” whereafter it’ll automatically get replaced by a corresponding short link.</p>
<h2 id="The_components">The components</h2>
<p>I won’t be hooking into any of the existing short link services as I really wan’t to show how such a service could be created from the bottom up, it’s actually quite simple. The complete service covers four separate projects. We have the actual Internet Explorer addin which is written in JavaScript. Then we have a .NET DLL that’ll be installed on the client machine, this is the one that’ll take care of the communication with the short link server. Furthermore we have the “Create a short link” webservice that’ll handle the actual creation of short links. And finally we have the short link redirection website which ensures that <a href="http://link.improve.dk/*" target="_blank">http://link.improve.dk/*</a> redirects to the URL that’s behind it.</p>
<h2 id="The_database">The database</h2>
<p>For storing the short links I’m using a MS SQL server database, of course you can use any kind of storage you want, whether that be Access, XML or some other format. The table I’ll be using can be seen here:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [dbo].[tblShortLinks](
	[LinkID] [<span class="keyword">int</span>] <span class="keyword">IDENTITY</span>(<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,
	[URL] [<span class="keyword">varchar</span>](<span class="number">512</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,
	[Created] [datetime] <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">CONSTRAINT</span> [DF_tblShortLinks_Created] <span class="keyword">DEFAULT</span> (getdate()),
	[IP] [<span class="keyword">varchar</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,
	[Visits] [<span class="keyword">int</span>] <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">CONSTRAINT</span> [DF_tblShortLinks_Visits] <span class="keyword">DEFAULT</span> (<span class="number">0</span>))</span>
</pre></figure>

<p>We have an identity column, the URL, a column reprensenting the creation time of the link, the IP of the creator (for abuse checking) and finally a simple counter that counts how many times the link has been visited.</p>
<h2 id="The_“Create_a_short_link_webservice”_–_ShortLinkService">The “Create a short link webservice” – ShortLinkService</h2>
<p>I’ll dive right into it and present the complete code for the webservice, ShortLinkService.cs:</p>
<figure class="highlight csharp"><pre><span class="keyword">using</span> System.Web.Services;
<span class="keyword">using</span> System.Data.SqlClient;
<span class="keyword">using</span> System.Data;
<span class="keyword">using</span> System.Web;
<span class="keyword">using</span> System;
<span class="keyword">using</span> System.Text.RegularExpressions;

[WebService(Namespace = <span class="string">"http://link.improve.dk"</span>)]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
<span class="keyword">public</span> <span class="keyword">class</span> ShortLinkService : WebService
{
	[WebMethod]
	<span class="keyword">public</span> <span class="keyword">string</span> <span class="title">CreateShortLinkFromURL</span>(<span class="keyword">string</span> url)
	{
		<span class="comment">// We won't handle invalid URL's</span>
		<span class="keyword">if</span> (!Regex.IsMatch(url, <span class="string">@"[-w.]+://([-w.]+)+(:d+)?(:w+)?(@d+)?(@w+)?([-w.]+)(/([w/_.]*(?S+)?)?)?"</span>))
			<span class="keyword">return</span> <span class="string">"BAD URL"</span>;

		<span class="comment">// Create a SqlCommand that'll lookup the URL to see if it already exists</span>
		SqlCommand cmd = <span class="keyword">new</span> SqlCommand(<span class="string">"SELECT LinkID FROM tblShortLinks WHERE URL = @URL"</span>);
		cmd.Parameters.Add(<span class="string">"@URL"</span>, SqlDbType.VarChar, <span class="number">512</span>).Value = url;

		<span class="keyword">object</span> result = DB.GetScalar(cmd);

		<span class="comment">// If it exists, just return the existing short link</span>
		<span class="keyword">if</span> (result != <span class="keyword">null</span>)
			<span class="keyword">return</span> <span class="string">"http://link.improve.dk/"</span> + result;
		<span class="keyword">else</span>
		{
			<span class="comment">// Since it doesn't exist, create it and return the new link</span>
			cmd = <span class="keyword">new</span> SqlCommand(<span class="string">"INSERT INTO tblShortLinks (URL, IP) VALUES (@URL, @IP); SELECT @@IDENTITY"</span>);
			cmd.Parameters.Add(<span class="string">"@URL"</span>, SqlDbType.VarChar, <span class="number">512</span>).Value = url;
			cmd.Parameters.Add(<span class="string">"@IP"</span>, SqlDbType.VarChar, <span class="number">50</span>).Value = HttpContext.Current.Request.UserHostAddress;

			<span class="keyword">return</span> <span class="string">"http://link.improve.dk/"</span> + Convert.ToInt32(DB.GetScalar(cmd));
		}
	}
}
</pre></figure>

<p>First of all we have to make a crude check to see if it’s a valid URL, if not, we won’t handle it. Next we’ll try and see if the requested URL already exists as a short link. If it does we might as well just return that instead of creating a new one.</p>
<p>Please don’t get confused by my call to another class that I use (which I won’t be presenting): DB.GetScalar(). What DB.GetScalar() does is to simply connect to my database and run the SqlCommand on it, returning the scalar value of the query. I’ve kept this code separate as it would only clutter the real purpose of this code.</p>
<p>After getting the value of the SQL query we check if the link exists. If it does we return the short link URL, if not, we create the short link while selecting the newly created identity value at the same time. And then finally we return the URL, just as if it already existed.</p>
<p>That was the complete short link webservice code. All it does is to simply take a URL and return a corresponding short url.</p>
<h2 id="The_redirector_website">The redirector website</h2>
<p>This is the website running at <a href="http://link.improve.dk" target="_blank">http://link.improve.dk</a>. I’ve setup <a href="http://scottwater.com/blog/articles/Wildcard.aspx" target="_blank">wildcard mapping</a> so all requests passes through to the ASPNET engine. This enables me to write the redirection functionality in the Global.asax file like so:</p>
<figure class="highlight csharp"><pre><span class="keyword">using</span> System.Web;
<span class="keyword">using</span> System;
<span class="keyword">using</span> System.Text.RegularExpressions;
<span class="keyword">using</span> System.Data.SqlClient;
<span class="keyword">using</span> System.Data;

<span class="keyword">public</span> <span class="keyword">class</span> Global : HttpApplication
{
	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Application_BeginRequest</span>(<span class="keyword">object</span> sender, EventArgs e)
	{
		<span class="keyword">string</span> input = Request.Path.Replace(<span class="string">"/"</span>, <span class="string">""</span>);

		<span class="comment">// Let's do a simple validation, the input has to be a number</span>
		<span class="keyword">if</span> (!Regex.IsMatch(input, <span class="string">@"^d+$"</span>))
			DB.Debug(<span class="string">"Not a valid short link."</span>);

		<span class="keyword">int</span> linkID = Convert.ToInt32(input);

		<span class="comment">// Lookup URL in database</span>
		SqlCommand cmd = <span class="keyword">new</span> SqlCommand(<span class="string">"UPDATE tblShortLinks SET Visits = Visits + 1 WHERE LinkID = @LinkID; SELECT URL FROM tblShortLinks WHERE LinkID = @LinkID"</span>);
		cmd.Parameters.Add(<span class="string">"@LinkID"</span>, SqlDbType.Int).Value = linkID;

		<span class="keyword">object</span> url = DB.GetScalar(cmd);

		<span class="keyword">if</span> (url != <span class="keyword">null</span>)
			Response.Redirect(url.ToString());
		<span class="keyword">else</span>
			DB.Debug(<span class="string">"Link does not exist."</span>);
	}
}
</pre></figure>

<p>First of all we retrieve the input value which consists of the requested path - exluding the leading forward slash. Then we perform a very quick input validation, checking that the requested path is a number. Most short link services use a combination of numbers and alphanumeric characters to keep the actual URL as short as possible. While this is a much better solution, I’ve stuck to the simple version by simple using numbers.</p>
<p>After retrieving the link ID from the requested path, we look it up in the database - and incrementing the visits count at the same time. If it exists then we perform a Response.Redirect to the requested URL, if it doesn’t exist then we write an error output.</p>
<p>The DB.Debug() function is very simple. All it does is to perform a Response.Write() of the passed object and then a Response.End() afterwards, very retro debugging stylish. This concludes the complete short link redirection website.</p>
<h2 id="The_managed_clientside_library_–_ShortLinkClient">The managed clientside library – ShortLinkClient</h2>
<p>This is where things start to get interesting. This library is the .NET class that’ll take care of communicating with the ShortLinkService webservice from the client computer. The ShortLinkClient library will be invoked from the Internet Explorer addin through COM (as we <em>have</em> to use JavaScript for the actual addin, unfortunately).</p>
<p>Start by creating a new class library project. Now either delete the Class1.cs or rename it to your liking. Then add a web reference to the following web service:<a href="http://linkservice.improve.dk/ShortLinkService.asmx" target="_blank">http://linkservice.improve.dk/ShortLinkService.asmx</a>. As this library has to be exported to COM we have to sign it using a strong name key file. Fortunately this is quite simple in Visual Studio 2005:</p>
<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink2_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Simply right click the ShortLinkClient project and select properties. Then go to the Signing tab, check “Sign the assembly” and choose “New…” from the dropdown list. This’ll create a new strong name key file for the library. You do not have to password protect it.</p>
<p>Make sure the ShortLinkClient.cs code matches the following:</p>
<figure class="highlight csharp"><pre><span class="keyword">using</span> System.Runtime.InteropServices;
<span class="keyword">using</span> System.Text.RegularExpressions;

namespace Improve
{
	[ComVisible(<span class="keyword">true</span>)]
	<span class="keyword">public</span> <span class="keyword">class</span> ShortLinkClient
	{
		<span class="keyword">public</span> <span class="title">ShortLinkClient</span>()
		{
		}

		<span class="keyword">public</span> <span class="keyword">string</span> <span class="title">CreateShortLink</span>(<span class="keyword">string</span> url)
		{
			LinkService.ShortLinkService shortLinkService = <span class="keyword">new</span> LinkService.ShortLinkService();

			<span class="keyword">return</span> shortLinkService.CreateShortLinkFromURL(url);
		}

		<span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">IsLink</span>(<span class="keyword">string</span> text)
		{
			<span class="keyword">return</span> Regex.IsMatch(text, <span class="string">@"[-w.]+://([-w.]+)+(:d+)?(:w+)?(@d+)?(@w+)?([-w.]+)(/([w/_.]*(?S+)?)?)?"</span>);
		}
	}
}
</pre></figure>

<p>By default our .NET classes are not visible to COM when it’s exported, that why we have to set the [ComVisible(true)] attribute on the ShortLinkClient class. Also, for our class to be usable by COM, we have to create a constructor that takes no parameters, otherwise COM won’t be able to use our class.</p>
<p>The IsLink function is used to determine whether the right clicked text is actually a valid URL or if it’s just plain text.</p>
<p>CreateShortLink takes the URL as a parameter. It then creates an instance of our ShortLinkService proxy class whereafter it invokes the CreateShortLinkFromURL function of the webservice which should return the short link equivalence of the passed URL. This is the only managed code that will run on the client as part of the Internet Explorer addin.</p>
<p>After building the ShortLinkClient project, register it for COM interop using the following command from a command prompt:</p>
<figure class="highlight shell"><pre>regasm /codebase ShortLinkClient<span class="preprocessor">.dll</span>
</pre></figure>

<p>To unregister, simply switch the /codebase switch with /unregister. You may have to close any open Internet Explorer windows in case the library has been invoked through the addin as these windows otherwise may lock the dll file.</p>
<h2 id="Creating_the_actual_addin">Creating the actual addin</h2>
<p>Unfortunately Internet Explorer lacks a bit when it comes to creating add ins for the context menu. I’d really like to be able to write in managed code all the way, but as things are currently, this part has to be written in JavaScript.</p>
<p>To register the addin, create a new registry key in the following location: HKEY_CURRENT_USER/Software/Microsoft/Internet Explorer/MenuExt. The key should have the name that you want to be present in the context menu. In my case that’d result in the following key being created: “HKEY_CURRENT_USER/Software/Microsoft/Internet Explorer/MenuExt/Replace with short link”.</p>
<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink3_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink3_2.jpg" style="max-height: 250px"/></a></div></div>

<p>The default value should point to the location where you want your javascript file to be located. For development purposes you can place this anywhere you want (I’m using the desktop). For deployment you might want to consider using the Program Files folder.</p>
<figure class="highlight javascript"><pre>&lt;script type=<span class="string">"text/javascript"</span>&gt;
	<span class="comment">// &lt;![CDATA[</span>
	<span class="function"><span class="keyword">function</span> <span class="title">main</span><span class="params">()</span>
	{</span>
		<span class="comment">// Get document reference</span>
		<span class="keyword">var</span> doc = external.menuArguments.document;
		<span class="keyword">var</span> range = doc.selection.createRange();

		<span class="comment">// Check if any text has been selected</span>
		<span class="keyword">if</span>(!range.text)
		{
			alert(<span class="string">'No text selected.'</span>);
			<span class="keyword">return</span>;
		}

		<span class="comment">// Create the ShortLinkClient object</span>
		<span class="keyword">var</span> shortLinkClient = <span class="keyword">new</span> ActiveXObject(<span class="string">'Improve.ShortLinkClient'</span>);

		<span class="comment">// If link starts with www, let's add http:// for convenience</span>
		<span class="keyword">var</span> link = range.text.indexOf(<span class="string">'www'</span>) == <span class="number">0</span> ? <span class="string">'http://'</span> + range.text : range.text;

		<span class="comment">// Check if selected text is actually a URL</span>
		<span class="keyword">if</span>(!shortLinkClient.IsLink(link))
		{
			alert(<span class="string">'Selected text is not a valid URL.'</span>);
			<span class="keyword">return</span>;
		}

		<span class="comment">// Get a short link</span>
		<span class="keyword">var</span> shortLink = shortLinkClient.CreateShortLink(link);

		<span class="comment">// Replace the selected text with the short link</span>
		range.text = shortLink;
	}

	main();
	<span class="comment">// ]]&gt;</span>
&lt;<span class="regexp">/script&gt;</span>
</pre></figure>

<p>The JavaScript file contains absolutely standard JavaScript code inside a normal script element. In the main function we can access the relevant html Document by accessing the external.menuArguments.document property. We can retrieve the selected text by creating a range using the Document.selection.createRange() function.</p>
<p>First we have to check whether any text was selected at all. Then we create an instance of the ShortLinkClient library (remember, it’ll have to be registered for COM interop for this to work - using regasm).</p>
<p>For convenience I’ll add http:// in case the link starts with www. For it to be a valid link it has to be in the form protocol://*, so by adding the http:// I’ll allow users to shortlink links like “www.improve.dk” instead of them having to type the complete <a href="http://www.improve.dk" target="_blank">http://www.improve.dk</a>.</p>
<p>Next we check whether the selected text is a link by using the ShortLinkClient.IsLink() function, passing in the selected text. If everything passes thus far, we invoke the ShortLinkClient.CreateShortLink() function which’ll invoke the webservice and create the short link - and return the short link URL which we will the use the replace the selected text with in the last line of the main function.</p>
<p>If all goes well, this should be the result of our four components working together:</p>
<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink4_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink4_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Downloads">Downloads</h2>
<p><a href="short_link_code.zip">short_link_code.zip - Sample solution</a></p>
<h2 id="Improvements">Improvements</h2>
<p>Many features of this example can be improved if this was meant to be deployed for real. For instance the regular expressions may not match all valid URL’s. Also we should probably make some kind of “loading” text while the webservice creates the short link, instead of letting the user sit there for a second or two before the short link emerges (the first time it’s called it’ll take some time, afterwards it should be nearly instant).</p>
<p>Please let me know if you have any suggestions, questions or any other relevant comments, thanks!</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">13</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/sql-server-datetime-rounding-made-easy/" title="SQL Server Datetime Rounding Made Easy" rel="bookmark">SQL Server Datetime Rounding Made Easy</a></h1>
		<div class="categories">
			
				<a href="/category/SQL Server/">SQL Server</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p><strong>Update:</strong> As noted in the comments, this method does not actually round, it truncates the datetime value.</p>
<a id="more"></a>

<p>As feature complete as MS SQL Server may be, it really lacks some simple datetime rounding functions. Here is a simple trick to easily round of datetimes at any precision you wish.</p>
<p>We will be using two builtin functions, namely the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_da-db_3vtw.asp" target="_blank">DATEADD</a> and the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_da-db_5vxi.asp" target="_blank">DATEDIFF</a> function.</p>
<p>We can round off at nearly any precision that SQL Server itself supports, for instance: Minute, Day, Hour, Day, Month, Year and so forth.</p>
<p>In this example I’ll select the original “Created” column from the table tblHits, as well as a rounding of the Created column by the day:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">SELECT</span> Created,
	DATEADD(<span class="keyword">Day</span>, DATEDIFF(<span class="keyword">Day</span>, <span class="number">0</span>, Created), <span class="number">0</span>) <span class="keyword">AS</span> CreatedDay
<span class="keyword">FROM</span> tblHits</span>
</pre></figure>

<p>It’ll return the following original / rounded values:</p>
<figure class="highlight"><pre><span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">22</span>:<span class="number">39</span>:<span class="number">27</span> -&gt; <span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>
<span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">31</span> -&gt; <span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>
<span class="keyword">...</span>
</pre></figure>

<p>And naturally we can do the same, this time rounded by the hour:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">SELECT</span> Created,
	DATEADD(<span class="keyword">Hour</span>, DATEDIFF(<span class="keyword">Hour</span>, <span class="number">0</span>, Created), <span class="number">0</span>) <span class="keyword">AS</span> CreatedHour
<span class="keyword">FROM</span> tblHits</span>
</pre></figure>

<p>It’ll return the following:</p>
<figure class="highlight"><pre><span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">22</span>:<span class="number">39</span>:<span class="number">27</span> -&gt; <span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">22</span>:<span class="number">39</span>:<span class="number">00</span>
<span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">31</span> -&gt; <span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">00</span>
<span class="keyword">...</span>
</pre></figure>

<p>You could of course also do the rounding on the webserver after you’ve selected the database results. Sometimes though, we have to do it at the database level. For instance, if I want to know how many visitors I have per day on my blog:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">SELECT</span> <span class="aggregate">COUNT</span>(<span class="number">1</span>) <span class="keyword">AS</span> Visitors,
	DATEADD(<span class="keyword">Day</span>, DATEDIFF(<span class="keyword">Day</span>, <span class="number">0</span>, Created), <span class="number">0</span>) <span class="keyword">AS</span> <span class="keyword">Date</span>
<span class="keyword">FROM</span> tblHits
<span class="keyword">GROUP</span> <span class="keyword">BY</span> DATEADD(<span class="keyword">Day</span>, DATEDIFF(<span class="keyword">Day</span>, <span class="number">0</span>, Created), <span class="number">0</span>)
<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">Date</span> <span class="keyword">DESC</span></span>
</pre></figure>

<p>Now, I know that this is not optimal in terms of performance since we’re doing the DATEADD(DATEDIFF()) trick twice to both select it and group by it, but I’ve kept it this way to follow the <a href="http://en.wikipedia.org/wiki/KISS_principle" target="_blank">KISS principle</a>.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>


<div class="paging">
	<a href="/page/22/"><div class="past">« Past</div></a>
	<a href="/page/20/"><div class="future">Future »</div></a>
	<div class="clear"></div>
</div>

				</div>
			</div>

			<div id="asides">
				<div class="categories aside">
					<span class="sectiontitle">CATEGORIES</span>
					<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/category/.NET/">.NET</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/AS/Flex/Flash/">AS/Flex/Flash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Amazon Web Services/">Amazon Web Services</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Computer Science/">Computer Science</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Conferences and Presenting/">Conferences and Presenting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/IIS/">IIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Life/">Life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Miscellaneous/">Miscellaneous</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Performance/">Performance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Poker/">Poker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server/">SQL Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Community/">SQL Server - Community</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Data Types/">SQL Server - Data Types</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Internals/">SQL Server - Internals</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Optimization/">SQL Server - Optimization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - OrcaMDF/">SQL Server - OrcaMDF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Tricks/">SQL Server - Tricks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Testing/">Testing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Tools of the Trade/">Tools of the Trade</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Umbraco/">Umbraco</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Visual Studio/">Visual Studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Web/">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Windbg/">Windbg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Windows/">Windows</a></li></ul>

					
				</div>

				<div class="archive aside">
					<span class="sectiontitle">ARCHIVE</span>
					<ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archive/2014">2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2013">2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2012">2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2011">2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2010">2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2009">2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2008">2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2007">2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2006">2006</a></li></ul>
				</div>
			</div>

			<div class="clear"></div>
		</div>
		
		<footer>
			<div class="wrapper">Copyright &copy; 2014 Mark S. Rasmussen</div>
		</footer>

		<script type="text/javascript">
			$(function () {
				// Show mobile menu
				$("li.navicon").click(function () {
					if ($("header ul.mobile a").length == 0) {
						// Pages
						$mobilePages = $("div#naviconcontent ul.pages");
						$("header nav ul.normal > li").not(".navicon").each(function (i, el) {
							$mobilePages.append($(el).clone());
						});

						// Categories
						$mobileCategories = $("div#naviconcontent ul.categories");
						$("div#asides div.categories > ul > li").each(function (i, el) {
							$mobileCategories.append($(el).clone());
						});

						// Archive
						$mobileArchive = $("div#naviconcontent ul.archive");
						$("div#asides div.archive > ul > li").each(function (i, el) {
							$mobileArchive.append($(el).clone());
						});
					};

					$("header ul.mobile").toggle();
				});

				// Fancybox setup
				$("a.fancy").fancybox({
					hideOnContentClick: true,
					overlayShow: true
				});
			});
		</script>
	</body>
</html>