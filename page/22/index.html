<!DOCTYPE html>
<html>
	

<head>
	<title>Mark S. Rasmussen</title>
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
	<meta charset="UTF-8" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="website" />
	<meta name="google-site-verification" content="alt7-wfK3ZujMQ4D0jYNd0yC5LGetGdqBlBmZsqQlVw" />
	<meta content="article" property="og:type">
<meta content="Mark S. Rasmussen" property="og:title">
<meta content="http://improve.dk/page/22/" property="og:url">
<meta property="og:image">
<meta content="Mark S. Rasmussen" property="og:site_name">
<meta property="og:description">
<meta content="summary" name="twitter:card">
	<link rel="alternative" href="http://feeds.feedburner.com/Improvedk" title="Mark S. Rasmussen" type="application/atom+xml">
	<script src="/js/combined.js"></script>
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-2479580-1', 'improve.dk');
		ga('require', 'displayfeatures');
		ga('send', 	'pageview');
	</script>
	<link rel="stylesheet" href="/css/style.css" type="text/css" />
</head>
	<body>
		<div id="headerline"></div>
	
		<header>
			<div class="wrapper">
				<div id="title">
					<a href="/">Mark S. Rasmussen</a> <span>improve.dk</span>
				</div>
				
				<nav>
					<ul class="normal">
						<li class="navicon"></li>
						<li><a href="/about-me/">About Me</a></li>
					</ul>
				</nav>
				
				<ul id="sharing">
					<li><a href="mailto:mark@improve.dk" id="shareat"></a></li>
					<li><a href="http://feeds.feedburner.com/Improvedk" id="rssfeed"></a></li>
					<li><a href="https://twitter.com/improvedk" id="sharetwitter"></a></li>
					<li><a href="https://github.com/improvedk" id="sharegithub"></a></li>
					<li><a href="https://www.linkedin.com/in/markrasmussen/" id="sharelinkedin"></a></li>
				</ul>

				<div class="clear"></div>
				
				<div id="naviconcontent">
					<ul class="mobile">
						<li>
							Pages
							<ul class="pages"></ul>
						</li>
						<li>
							Categories
							<ul class="categories"></ul>
						</li>
						<li>
							Archive
							<ul class="archive"></ul>
						</li>
					</ul>
				</div>
			</div>
		</header>

		<div id="mainwrapper">
			<div id="contentwrapper">
				<div id="content">
				
					
	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">26</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/executing-assembly-dynamically-in-a-strongly-typed-way/" title="Executing Assembly Dynamically In a Strongly Typed Way" rel="bookmark">Executing Assembly Dynamically In a Strongly Typed Way</a></h1>
		<div class="categories">
			
				<a href="/category/.NET/">.NET</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>During a recent plugin based project that I worked upon, I had to dynamically load assemblies and instantiate objects from those assemblies. Usually that’d require a lot of typecasting and nasty code, but thanks to generics we can make it a lot smoother.</p>
<a id="more"></a>

<p>I present to you my LoadPlugin function of my PluginHandler module:</p>
<figure class="highlight cs"><pre><span class="keyword">using</span> System.Reflection;
<span class="keyword">using</span> System;

namespace MTH.Core
{
	<span class="keyword">internal</span> <span class="keyword">class</span> PluginHandler
	{
		<span class="keyword">public</span> <span class="keyword">static</span> T LoadPlugin&lt;T&gt;(<span class="keyword">string</span> file)
		{
			Assembly ass = Assembly.LoadFile(file);

			<span class="keyword">foreach</span> (Type t <span class="keyword">in</span> ass.GetTypes())
				<span class="keyword">if</span> (<span class="keyword">typeof</span>(T).IsAssignableFrom(t))
					<span class="keyword">return</span> (T)ass.CreateInstance(t.FullName);

			<span class="keyword">return</span> <span class="keyword">default</span>(T);
		}
	}
}
</pre></figure>

<p>The generic parameter defines the type that should be created from the specified assembly file, this also means that the function will return a strongly typed result of this specific type.</p>
<p>Inside the function we load the assembly and load through each type it hosts. For each type we check the IsAssignableFrom function which’ll check if the current type is of the specified type T, no matter if T is an abstract class, interface or any other type. If it matches, we return a new instance of that type. If no type match is found we return null so we can handle the problem in the calling function.</p>
<p>Note that this is a very simple example function, there are many unhandled parameters! Security for instance. In most scenarios you would probably want to check the identity of the loaded assembly and set the security permissions dependingly. Also it is not possible to pass constructor parameters, this would require an extension of the function to take in an array of objects as constructor parameters.</p>
<p>This is how easily we can load any number of plugins that have been placed in a certain plugin directory (in this case the plugins contains code that is to be run on application startup):</p>
<figure class="highlight cs"><pre><span class="keyword">foreach</span> (<span class="keyword">string</span> file <span class="keyword">in</span> Directory.GetFiles(Application.StartupPath + <span class="string">"\Plugins\Startup"</span>, <span class="string">"*.dll"</span>))
{
	IRunnable startupPlugin = PluginHandler.LoadPlugin&lt;IRunnable&gt;(file);

	<span class="keyword">if</span> (startupPlugin != <span class="keyword">null</span>)
		startupPlugin.Run();
}
</pre></figure>

<p>All that is required is that the assemblies in the PluginsStartup folder contain a type that implements the IRunnable interface:</p>
<figure class="highlight cs"><pre>
<span class="keyword">public</span> <span class="keyword">interface</span> IRunnable
{
	<span class="keyword">void</span> Run();
}
</pre></figure>



				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">16</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/creating-a-short-link-internet-explorer-addin/" title="Creating a &quot;Shorten Link&quot; Internet Explorer Addin" rel="bookmark">Creating a &quot;Shorten Link&quot; Internet Explorer Addin</a></h1>
		<div class="categories">
			
				<a href="/category/.NET/">.NET</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>You probably already know of the short link services that are around, <a href="http://makeashorterlink.com/index.php" target="_blank">www.makeashorterlink.com</a> for instance. While the idea behind these sites are indeed good, I personally find it quite cumbersome to actually create the short links when I’m typing a forum post somewhere. In this post I’ll give an example of a short link system that enables one to easily create short links while typing in Internet Explorer, using an Internet Explorer addon that conveniently places itself in the context menu whenever we right click on some text and a .NET webservice that handles the short link functionality.</p>
<a id="more"></a>

<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink1_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink1_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="What’s_a_short_link?">What’s a short link?</h2>
<p>I’ll keep this part short (pun intended). Often when writing in forums, emails, newsgroups and so forth, we need to post links. The problem arises when we have to post a link like this: <a href="http://www.experts-exchange.com/Programming/Programming_Languages/C_Sharp/Q_20801558.html" target="_blank">http://www.experts-exchange.com/Programming/Programming_Languages/C_Sharp/Q_20801558.html</a>, it’s quite large! This may easily ruin the desing of the website and annoy people as it takes up a lot of space. A short link equivalence is: <a href="http://link.improve.dk/8" target="_blank">http://link.improve.dk/8</a>.</p>
<h2 id="The_idea">The idea</h2>
<p>So how can we make it more convenient, so we won’t have to open up a new browser, go to the short link website, create the short link and copy it back into the other browser window? My proposal is that we create an Internet Explorer addin for the context menu like shown in the picture above. That means we can simply type the long url as normally, select it and the right click and select “Replace with short link” whereafter it’ll automatically get replaced by a corresponding short link.</p>
<h2 id="The_components">The components</h2>
<p>I won’t be hooking into any of the existing short link services as I really wan’t to show how such a service could be created from the bottom up, it’s actually quite simple. The complete service covers four separate projects. We have the actual Internet Explorer addin which is written in JavaScript. Then we have a .NET DLL that’ll be installed on the client machine, this is the one that’ll take care of the communication with the short link server. Furthermore we have the “Create a short link” webservice that’ll handle the actual creation of short links. And finally we have the short link redirection website which ensures that <a href="http://link.improve.dk/*" target="_blank">http://link.improve.dk/*</a> redirects to the URL that’s behind it.</p>
<h2 id="The_database">The database</h2>
<p>For storing the short links I’m using a MS SQL server database, of course you can use any kind of storage you want, whether that be Access, XML or some other format. The table I’ll be using can be seen here:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [dbo].[tblShortLinks](
	[LinkID] [<span class="keyword">int</span>] <span class="keyword">IDENTITY</span>(<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,
	[URL] [<span class="keyword">varchar</span>](<span class="number">512</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,
	[Created] [datetime] <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">CONSTRAINT</span> [DF_tblShortLinks_Created] <span class="keyword">DEFAULT</span> (getdate()),
	[IP] [<span class="keyword">varchar</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,
	[Visits] [<span class="keyword">int</span>] <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">CONSTRAINT</span> [DF_tblShortLinks_Visits] <span class="keyword">DEFAULT</span> (<span class="number">0</span>))</span>
</pre></figure>

<p>We have an identity column, the URL, a column reprensenting the creation time of the link, the IP of the creator (for abuse checking) and finally a simple counter that counts how many times the link has been visited.</p>
<h2 id="The_“Create_a_short_link_webservice”_–_ShortLinkService">The “Create a short link webservice” – ShortLinkService</h2>
<p>I’ll dive right into it and present the complete code for the webservice, ShortLinkService.cs:</p>
<figure class="highlight cs"><pre><span class="keyword">using</span> System.Web.Services;
<span class="keyword">using</span> System.Data.SqlClient;
<span class="keyword">using</span> System.Data;
<span class="keyword">using</span> System.Web;
<span class="keyword">using</span> System;
<span class="keyword">using</span> System.Text.RegularExpressions;

[WebService(Namespace = <span class="string">"http://link.improve.dk"</span>)]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
<span class="keyword">public</span> <span class="keyword">class</span> ShortLinkService : WebService
{
	[WebMethod]
	<span class="keyword">public</span> <span class="keyword">string</span> <span class="title">CreateShortLinkFromURL</span>(<span class="keyword">string</span> url)
	{
		<span class="comment">// We won't handle invalid URL's</span>
		<span class="keyword">if</span> (!Regex.IsMatch(url, <span class="string">@"[-w.]+://([-w.]+)+(:d+)?(:w+)?(@d+)?(@w+)?([-w.]+)(/([w/_.]*(?S+)?)?)?"</span>))
			<span class="keyword">return</span> <span class="string">"BAD URL"</span>;

		<span class="comment">// Create a SqlCommand that'll lookup the URL to see if it already exists</span>
		SqlCommand cmd = <span class="keyword">new</span> SqlCommand(<span class="string">"SELECT LinkID FROM tblShortLinks WHERE URL = @URL"</span>);
		cmd.Parameters.Add(<span class="string">"@URL"</span>, SqlDbType.VarChar, <span class="number">512</span>).Value = url;

		<span class="keyword">object</span> result = DB.GetScalar(cmd);

		<span class="comment">// If it exists, just return the existing short link</span>
		<span class="keyword">if</span> (result != <span class="keyword">null</span>)
			<span class="keyword">return</span> <span class="string">"http://link.improve.dk/"</span> + result;
		<span class="keyword">else</span>
		{
			<span class="comment">// Since it doesn't exist, create it and return the new link</span>
			cmd = <span class="keyword">new</span> SqlCommand(<span class="string">"INSERT INTO tblShortLinks (URL, IP) VALUES (@URL, @IP); SELECT @@IDENTITY"</span>);
			cmd.Parameters.Add(<span class="string">"@URL"</span>, SqlDbType.VarChar, <span class="number">512</span>).Value = url;
			cmd.Parameters.Add(<span class="string">"@IP"</span>, SqlDbType.VarChar, <span class="number">50</span>).Value = HttpContext.Current.Request.UserHostAddress;

			<span class="keyword">return</span> <span class="string">"http://link.improve.dk/"</span> + Convert.ToInt32(DB.GetScalar(cmd));
		}
	}
}
</pre></figure>

<p>First of all we have to make a crude check to see if it’s a valid URL, if not, we won’t handle it. Next we’ll try and see if the requested URL already exists as a short link. If it does we might as well just return that instead of creating a new one.</p>
<p>Please don’t get confused by my call to another class that I use (which I won’t be presenting): DB.GetScalar(). What DB.GetScalar() does is to simply connect to my database and run the SqlCommand on it, returning the scalar value of the query. I’ve kept this code separate as it would only clutter the real purpose of this code.</p>
<p>After getting the value of the SQL query we check if the link exists. If it does we return the short link URL, if not, we create the short link while selecting the newly created identity value at the same time. And then finally we return the URL, just as if it already existed.</p>
<p>That was the complete short link webservice code. All it does is to simply take a URL and return a corresponding short url.</p>
<h2 id="The_redirector_website">The redirector website</h2>
<p>This is the website running at <a href="http://link.improve.dk" target="_blank">http://link.improve.dk</a>. I’ve setup <a href="http://scottwater.com/blog/articles/Wildcard.aspx" target="_blank">wildcard mapping</a> so all requests passes through to the ASPNET engine. This enables me to write the redirection functionality in the Global.asax file like so:</p>
<figure class="highlight cs"><pre><span class="keyword">using</span> System.Web;
<span class="keyword">using</span> System;
<span class="keyword">using</span> System.Text.RegularExpressions;
<span class="keyword">using</span> System.Data.SqlClient;
<span class="keyword">using</span> System.Data;

<span class="keyword">public</span> <span class="keyword">class</span> Global : HttpApplication
{
	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Application_BeginRequest</span>(<span class="keyword">object</span> sender, EventArgs e)
	{
		<span class="keyword">string</span> input = Request.Path.Replace(<span class="string">"/"</span>, <span class="string">""</span>);

		<span class="comment">// Let's do a simple validation, the input has to be a number</span>
		<span class="keyword">if</span> (!Regex.IsMatch(input, <span class="string">@"^d+$"</span>))
			DB.Debug(<span class="string">"Not a valid short link."</span>);

		<span class="keyword">int</span> linkID = Convert.ToInt32(input);

		<span class="comment">// Lookup URL in database</span>
		SqlCommand cmd = <span class="keyword">new</span> SqlCommand(<span class="string">"UPDATE tblShortLinks SET Visits = Visits + 1 WHERE LinkID = @LinkID; SELECT URL FROM tblShortLinks WHERE LinkID = @LinkID"</span>);
		cmd.Parameters.Add(<span class="string">"@LinkID"</span>, SqlDbType.Int).Value = linkID;

		<span class="keyword">object</span> url = DB.GetScalar(cmd);

		<span class="keyword">if</span> (url != <span class="keyword">null</span>)
			Response.Redirect(url.ToString());
		<span class="keyword">else</span>
			DB.Debug(<span class="string">"Link does not exist."</span>);
	}
}
</pre></figure>

<p>First of all we retrieve the input value which consists of the requested path - exluding the leading forward slash. Then we perform a very quick input validation, checking that the requested path is a number. Most short link services use a combination of numbers and alphanumeric characters to keep the actual URL as short as possible. While this is a much better solution, I’ve stuck to the simple version by simple using numbers.</p>
<p>After retrieving the link ID from the requested path, we look it up in the database - and incrementing the visits count at the same time. If it exists then we perform a Response.Redirect to the requested URL, if it doesn’t exist then we write an error output.</p>
<p>The DB.Debug() function is very simple. All it does is to perform a Response.Write() of the passed object and then a Response.End() afterwards, very retro debugging stylish. This concludes the complete short link redirection website.</p>
<h2 id="The_managed_clientside_library_–_ShortLinkClient">The managed clientside library – ShortLinkClient</h2>
<p>This is where things start to get interesting. This library is the .NET class that’ll take care of communicating with the ShortLinkService webservice from the client computer. The ShortLinkClient library will be invoked from the Internet Explorer addin through COM (as we <em>have</em> to use JavaScript for the actual addin, unfortunately).</p>
<p>Start by creating a new class library project. Now either delete the Class1.cs or rename it to your liking. Then add a web reference to the following web service:<a href="http://linkservice.improve.dk/ShortLinkService.asmx" target="_blank">http://linkservice.improve.dk/ShortLinkService.asmx</a>. As this library has to be exported to COM we have to sign it using a strong name key file. Fortunately this is quite simple in Visual Studio 2005:</p>
<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink2_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Simply right click the ShortLinkClient project and select properties. Then go to the Signing tab, check “Sign the assembly” and choose “New…” from the dropdown list. This’ll create a new strong name key file for the library. You do not have to password protect it.</p>
<p>Make sure the ShortLinkClient.cs code matches the following:</p>
<figure class="highlight cs"><pre><span class="keyword">using</span> System.Runtime.InteropServices;
<span class="keyword">using</span> System.Text.RegularExpressions;

namespace Improve
{
	[ComVisible(<span class="keyword">true</span>)]
	<span class="keyword">public</span> <span class="keyword">class</span> ShortLinkClient
	{
		<span class="keyword">public</span> <span class="title">ShortLinkClient</span>()
		{
		}

		<span class="keyword">public</span> <span class="keyword">string</span> <span class="title">CreateShortLink</span>(<span class="keyword">string</span> url)
		{
			LinkService.ShortLinkService shortLinkService = <span class="keyword">new</span> LinkService.ShortLinkService();

			<span class="keyword">return</span> shortLinkService.CreateShortLinkFromURL(url);
		}

		<span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">IsLink</span>(<span class="keyword">string</span> text)
		{
			<span class="keyword">return</span> Regex.IsMatch(text, <span class="string">@"[-w.]+://([-w.]+)+(:d+)?(:w+)?(@d+)?(@w+)?([-w.]+)(/([w/_.]*(?S+)?)?)?"</span>);
		}
	}
}
</pre></figure>

<p>By default our .NET classes are not visible to COM when it’s exported, that why we have to set the [ComVisible(true)] attribute on the ShortLinkClient class. Also, for our class to be usable by COM, we have to create a constructor that takes no parameters, otherwise COM won’t be able to use our class.</p>
<p>The IsLink function is used to determine whether the right clicked text is actually a valid URL or if it’s just plain text.</p>
<p>CreateShortLink takes the URL as a parameter. It then creates an instance of our ShortLinkService proxy class whereafter it invokes the CreateShortLinkFromURL function of the webservice which should return the short link equivalence of the passed URL. This is the only managed code that will run on the client as part of the Internet Explorer addin.</p>
<p>After building the ShortLinkClient project, register it for COM interop using the following command from a command prompt:</p>
<figure class="highlight shell"><pre>regasm /codebase ShortLinkClient<span class="preprocessor">.dll</span>
</pre></figure>

<p>To unregister, simply switch the /codebase switch with /unregister. You may have to close any open Internet Explorer windows in case the library has been invoked through the addin as these windows otherwise may lock the dll file.</p>
<h2 id="Creating_the_actual_addin">Creating the actual addin</h2>
<p>Unfortunately Internet Explorer lacks a bit when it comes to creating add ins for the context menu. I’d really like to be able to write in managed code all the way, but as things are currently, this part has to be written in JavaScript.</p>
<p>To register the addin, create a new registry key in the following location: HKEY_CURRENT_USER/Software/Microsoft/Internet Explorer/MenuExt. The key should have the name that you want to be present in the context menu. In my case that’d result in the following key being created: “HKEY_CURRENT_USER/Software/Microsoft/Internet Explorer/MenuExt/Replace with short link”.</p>
<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink3_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink3_2.jpg" style="max-height: 250px"/></a></div></div>

<p>The default value should point to the location where you want your javascript file to be located. For development purposes you can place this anywhere you want (I’m using the desktop). For deployment you might want to consider using the Program Files folder.</p>
<figure class="highlight javascript"><pre>&lt;script type=<span class="string">"text/javascript"</span>&gt;
	<span class="comment">// &lt;![CDATA[</span>
	<span class="function"><span class="keyword">function</span> <span class="title">main</span><span class="params">()</span>
	{</span>
		<span class="comment">// Get document reference</span>
		<span class="keyword">var</span> doc = external.menuArguments.document;
		<span class="keyword">var</span> range = doc.selection.createRange();

		<span class="comment">// Check if any text has been selected</span>
		<span class="keyword">if</span>(!range.text)
		{
			alert(<span class="string">'No text selected.'</span>);
			<span class="keyword">return</span>;
		}

		<span class="comment">// Create the ShortLinkClient object</span>
		<span class="keyword">var</span> shortLinkClient = <span class="keyword">new</span> ActiveXObject(<span class="string">'Improve.ShortLinkClient'</span>);

		<span class="comment">// If link starts with www, let's add http:// for convenience</span>
		<span class="keyword">var</span> link = range.text.indexOf(<span class="string">'www'</span>) == <span class="number">0</span> ? <span class="string">'http://'</span> + range.text : range.text;

		<span class="comment">// Check if selected text is actually a URL</span>
		<span class="keyword">if</span>(!shortLinkClient.IsLink(link))
		{
			alert(<span class="string">'Selected text is not a valid URL.'</span>);
			<span class="keyword">return</span>;
		}

		<span class="comment">// Get a short link</span>
		<span class="keyword">var</span> shortLink = shortLinkClient.CreateShortLink(link);

		<span class="comment">// Replace the selected text with the short link</span>
		range.text = shortLink;
	}

	main();
	<span class="comment">// ]]&gt;</span>
&lt;<span class="regexp">/script&gt;</span>
</pre></figure>

<p>The JavaScript file contains absolutely standard JavaScript code inside a normal script element. In the main function we can access the relevant html Document by accessing the external.menuArguments.document property. We can retrieve the selected text by creating a range using the Document.selection.createRange() function.</p>
<p>First we have to check whether any text was selected at all. Then we create an instance of the ShortLinkClient library (remember, it’ll have to be registered for COM interop for this to work - using regasm).</p>
<p>For convenience I’ll add http:// in case the link starts with www. For it to be a valid link it has to be in the form protocol://*, so by adding the http:// I’ll allow users to shortlink links like “www.improve.dk” instead of them having to type the complete <a href="http://www.improve.dk" target="_blank">http://www.improve.dk</a>.</p>
<p>Next we check whether the selected text is a link by using the ShortLinkClient.IsLink() function, passing in the selected text. If everything passes thus far, we invoke the ShortLinkClient.CreateShortLink() function which’ll invoke the webservice and create the short link - and return the short link URL which we will the use the replace the selected text with in the last line of the main function.</p>
<p>If all goes well, this should be the result of our four components working together:</p>
<div class="imgwrapper" style=""><div><a href="/creating-a-short-link-internet-explorer-addin/shortlink4_2.jpg" class="fancy"><img src="/creating-a-short-link-internet-explorer-addin/shortlink4_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Downloads">Downloads</h2>
<p><a href="short_link_code.zip">short_link_code.zip - Sample solution</a></p>
<h2 id="Improvements">Improvements</h2>
<p>Many features of this example can be improved if this was meant to be deployed for real. For instance the regular expressions may not match all valid URL’s. Also we should probably make some kind of “loading” text while the webservice creates the short link, instead of letting the user sit there for a second or two before the short link emerges (the first time it’s called it’ll take some time, afterwards it should be nearly instant).</p>
<p>Please let me know if you have any suggestions, questions or any other relevant comments, thanks!</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">13</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/sql-server-datetime-rounding-made-easy/" title="SQL Server Datetime Rounding Made Easy" rel="bookmark">SQL Server Datetime Rounding Made Easy</a></h1>
		<div class="categories">
			
				<a href="/category/SQL Server/">SQL Server</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p><strong>Update:</strong> As noted in the comments, this method does not actually round, it truncates the datetime value.</p>
<a id="more"></a>

<p>As feature complete as MS SQL Server may be, it really lacks some simple datetime rounding functions. Here is a simple trick to easily round of datetimes at any precision you wish.</p>
<p>We will be using two builtin functions, namely the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_da-db_3vtw.asp" target="_blank">DATEADD</a> and the <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_da-db_5vxi.asp" target="_blank">DATEDIFF</a> function.</p>
<p>We can round off at nearly any precision that SQL Server itself supports, for instance: Minute, Day, Hour, Day, Month, Year and so forth.</p>
<p>In this example I’ll select the original “Created” column from the table tblHits, as well as a rounding of the Created column by the day:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">SELECT</span> Created,
	DATEADD(<span class="keyword">Day</span>, DATEDIFF(<span class="keyword">Day</span>, <span class="number">0</span>, Created), <span class="number">0</span>) <span class="keyword">AS</span> CreatedDay
<span class="keyword">FROM</span> tblHits</span>
</pre></figure>

<p>It’ll return the following original / rounded values:</p>
<figure class="highlight"><pre><span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">22</span>:<span class="number">39</span>:<span class="number">27</span> -&gt; <span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>
<span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">31</span> -&gt; <span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>
<span class="keyword">...</span>
</pre></figure>

<p>And naturally we can do the same, this time rounded by the hour:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">SELECT</span> Created,
	DATEADD(<span class="keyword">Hour</span>, DATEDIFF(<span class="keyword">Hour</span>, <span class="number">0</span>, Created), <span class="number">0</span>) <span class="keyword">AS</span> CreatedHour
<span class="keyword">FROM</span> tblHits</span>
</pre></figure>

<p>It’ll return the following:</p>
<figure class="highlight"><pre><span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">22</span>:<span class="number">39</span>:<span class="number">27</span> -&gt; <span class="number">19</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">22</span>:<span class="number">39</span>:<span class="number">00</span>
<span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">31</span> -&gt; <span class="number">20</span>-<span class="number">11</span>-<span class="number">2006</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">00</span>
<span class="keyword">...</span>
</pre></figure>

<p>You could of course also do the rounding on the webserver after you’ve selected the database results. Sometimes though, we have to do it at the database level. For instance, if I want to know how many visitors I have per day on my blog:</p>
<figure class="highlight sql"><pre><span class="operator"><span class="keyword">SELECT</span> <span class="aggregate">COUNT</span>(<span class="number">1</span>) <span class="keyword">AS</span> Visitors,
	DATEADD(<span class="keyword">Day</span>, DATEDIFF(<span class="keyword">Day</span>, <span class="number">0</span>, Created), <span class="number">0</span>) <span class="keyword">AS</span> <span class="keyword">Date</span>
<span class="keyword">FROM</span> tblHits
<span class="keyword">GROUP</span> <span class="keyword">BY</span> DATEADD(<span class="keyword">Day</span>, DATEDIFF(<span class="keyword">Day</span>, <span class="number">0</span>, Created), <span class="number">0</span>)
<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">Date</span> <span class="keyword">DESC</span></span>
</pre></figure>

<p>Now, I know that this is not optimal in terms of performance since we’re doing the DATEADD(DATEDIFF()) trick twice to both select it and group by it, but I’ve kept it this way to follow the <a href="http://en.wikipedia.org/wiki/KISS_principle" target="_blank">KISS principle</a>.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">11</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/making-url-rewriting-on-iis7-work-like-iis6/" title="Making URL Rewriting on IIS 7 Work Like IIS 6" rel="bookmark">Making URL Rewriting on IIS 7 Work Like IIS 6</a></h1>
		<div class="categories">
			
				<a href="/category/IIS/">IIS</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>Upgrading to IIS 7 should be rather transparent, unfortunately that is not the case when it comes to URL rewriting as we knew it from IIS 6. In IIS 6 all we had to do was to add a wildcard mapping making sure that all requests went through the ASPNET ISAPI process. After this was done, one could create a global.asax file that would either pass requests directly through or rewrite the URL based on an internal algorithm.</p>
<a id="more"></a>

<p><strong>UPDATE: Please see my <a href="/how-to-do-url-rewriting-on-iis-7-properly">updated post</a> on how to do proper URL rewriting using IIS 7.</strong></p>
<p>I didn’t really expect this to be a problem when I first requested <a href="http://localhost" target="_blank">http://localhost</a> for the first time after setting up my site on IIS 7 (all default settings).</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur1_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur1_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Unfortunately this was what I was presented with. Anyone having worked with wildcard mappings from IIS 6 will recognize this, this is the result you’ll get after adding a wildcard mapping without having created your URL rewriting functionality. After adding a wildcard map the IIS will not automatically find a default file (by design).</p>
<p>This however, is not the problem cause here. I already have my URL rewriting functionality written in my global.asax BeginRequest method and I’d really like to just reuse my current code. Although the new IIS has a whole new bunch of features - one of them being a new “more correct” way of doing URL rewriting -, I really just wan’t to get my website up and running again so I can continue my work.</p>
<p>What I present below is a quick’n’dirty hack that will get my old URL rewriting code to work again. It may not be the IIS 7 way of doing it, and it may not work in your case, it depends on the type of URL mapping you’re doing in your project. In short, <a href="http://en.wikipedia.org/wiki/Your_mileage_may_vary" target="_blank">YMMV</a>.</p>
<h2 id="My_scenario">My scenario</h2>
<p>For this website, improve.dk, all URL’s except static files are requested as though they were folders. That means you will not see any pages ending in anything but a /. Any static files are requested as usual. That means I can be sure that a regular expression like <em>.</em> will catch all static files, while * will catch all pages - as well as the static files!</p>
<h2 id="How_I_got_URL_rewriting_to_work_like_IIS_6">How I got URL rewriting to work like IIS 6</h2>
<p>Start by opening the IIS Manager and selecting your website.</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur2_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Now enter the “Handler Mappings” section:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur3_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur3_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Notice the “StaticFile” handler. Currently it’s set to match <em> and catch both File and Directory requests. If you look back at the first image, you’ll notice that the error message details that the handler causing the 404 error is the StaticFile handler. As I know that all my static files will have a file extension (also I don’t care for directory browsing), I’ll simply change my StaticFile handler so it only matches </em>.* - and only files.</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur4_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur4_2.jpg" style="max-height: 250px"/></a></div></div>

<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur5_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur5_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Your StaticFile handler should now look like this:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur6_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur6_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Now, if you go back and make a request to <a href="http://localhost" target="_blank">http://localhost</a> you’ll still get the 404 error, but this time the request is not handled by the StaticFile handler, actually it doesn’t get handled by any handler at all:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur7_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur7_2.jpg" style="max-height: 250px"/></a></div></div>

<p>What needs to be done now is that we need to map any and all requests to the aspnet_isapi.dll isapi file - just like we would usually do in IIS 6.</p>
<p>Add a new Script Map to the list of Handler Mappings and set it up like this:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur8_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur8_2.jpg" style="max-height: 250px"/></a></div></div>

<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur9_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur9_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Click OK and click <em>Yes</em> at the confirmation dialog:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur10_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur10_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Now if you make a request to either <a href="http://localhost" target="_blank">http://localhost</a> or any other file you’ll get the following error:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur11_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur11_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Looking throug the Event log reveals the cause of the error:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur12_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur12_2.jpg" style="max-height: 250px"/></a></div></div>

<p>The aspnet_isapi.dll file cannot be used as a Handler for websites running in the new IIS 7 Integrated Mode, thus we will need to make our website run in classic .NET mode. Right click your website node in the IIS Manager and select Advanced Settings. Select the “Classic .NET AppPool” and close the dialog boxes:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur13_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur13_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Now you should be able to make a request to <a href="http://localhost" target="_blank">http://localhost</a> and see it work. Your URL rewriting should work as a charm aswell:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur14_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur14_2.jpg" style="max-height: 250px"/></a></div></div>

<p>But obviously somethings wrong. Making a request to any static file will reveal the problem:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur15_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur15_2.jpg" style="max-height: 250px"/></a></div></div>

<p>“Failed to Execute URL”, what a great descriptive error. Fortunately you won’t have to spend hours ripping out hair… As I have already done that - at least I’ll save a trip or two to the barber.</p>
<p>The problem is that the static files are being processed by the aspnet_isapi.dll file instead of simply sending the request along to the StaticFile handler. If you click the “View Ordered List…” link in the IIS Manager from the Handler Mappings view, you’ll see the order in which the handlers are being executed for each request:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur16_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur16_2.jpg" style="max-height: 250px"/></a></div></div>

<p>When you add a new Script Map it’ll automatically get placed at the very top of the line taking precedence over any other handlers, including the StaticFile one.</p>
<p>What we have to do is to move our Wildcard handler to the very bottom, below the StaticFile handler. By letting the StaticFile handler have precedence over our Wildcard handler we ensure that any static files (matching <em>.</em>) gets processed correctly while any other URL’s gets passed along to our own Wildcard handler that’ll do the URL rewriting and make business work as usual:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur17_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur17_2.jpg" style="max-height: 250px"/></a></div></div>

<p>After doing so, both static files as well as your custom URL’s should execute as they would under IIS 6:</p>
<div class="imgwrapper" style=""><div><a href="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur18_2.jpg" class="fancy"><img src="/making-url-rewriting-on-iis7-work-like-iis6/iis7ur18_2.jpg" style="max-height: 250px"/></a></div></div>

<h2 id="Disclaimer">Disclaimer</h2>
<p>Please notice that this is a hack. This is not the way URL rewriting is supposed to be done under IIS 7. But instead of spending hours upon hours investigating how to do it the right way, this is quick fix to make things work like they did before.</p>
<p>Also please note that this solution is intended to work for my specific situation. Your needs for URL rewriting may not necessarily match mine, so you may have to modify certain settings to suit your specific needs.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">08</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/missing-windows-mobile-device-center/" title="Missing Windows Mobile Device Center" rel="bookmark">Missing Windows Mobile Device Center</a></h1>
		<div class="categories">
			
				<a href="/category/Windows/">Windows</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>In an effort to get my HTC TyTN Windows Mobile 5 based PDA to synchronize with my Vista system, I downloaded the newest release of ActiveSync (4.2). This is what happens when you try to install ActiveSync on Vista:</p>
<a id="more"></a>

<div class="imgwrapper" style=""><div><a href="/missing-windows-mobile-device-center/wmdc5_2.jpg" class="fancy"><img src="/missing-windows-mobile-device-center/wmdc5_2.jpg" style="max-height: 250px"/></a></div></div>

<p>After searching for a solution it became apparent that Vista was born with the successor of ActiveSync, namely the Windows Mobile Device Center (WMDC in short, which is not to be mistaken for the Weapons of Mass Destruction Commission, which shares the same acronym).</p>
<div class="imgwrapper" style=""><div><a href="/missing-windows-mobile-device-center/wmdc6_2.jpg" class="fancy"><img src="/missing-windows-mobile-device-center/wmdc6_2.jpg" style="max-height: 250px"/></a></div></div>

<p>And whadda ya know, there it is, Windows Mobile Device Center. It really does come preinstalled, neat.</p>
<div class="imgwrapper" style=""><div><a href="/missing-windows-mobile-device-center/wmdc1_2.jpg" class="fancy"><img src="/missing-windows-mobile-device-center/wmdc1_2.jpg" style="max-height: 250px"/></a></div></div>

<p>But… If it’s pre installed, why is this all I get when I run the WMDC? Apparently it’s perfectly able to recognize that my device is connected.</p>
<div class="imgwrapper" style=""><div><a href="/missing-windows-mobile-device-center/wmdc3_2.jpg" class="fancy"><img src="/missing-windows-mobile-device-center/wmdc3_2.jpg" style="max-height: 250px"/></a></div></div>

<p>And furthermore it’s also able to recognize the name of the device, as well as the operating system, PPC 5.1 / Windows Mobile 5. But why is it not able to synchronize then?</p>
<p>For some reason the Windows Mobile Device Center is NOT preinstalled after all, or at least the actual Device Center isn’t, only the connectivity parts are. To use the Windows Mobile Device Center you’ll have to <a href="http://www.microsoft.com/downloads/details.aspx?FamilyId=C23C8E6A-A72D-4AEF-9663-31CE2FEFBADA&amp;displaylang=en" target="_blank">download the Beta 3 version of WMDC</a> and install it.</p>
<div class="imgwrapper" style=""><div><a href="/missing-windows-mobile-device-center/wmdc2_2.jpg" class="fancy"><img src="/missing-windows-mobile-device-center/wmdc2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>After installing the Beta 3 version of WMDC it runs perfectly. It really seems to be a lot more snappy and intuitive than the old ActiveSync.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">04</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/installing-office-2007-on-vista/" title="Installing Office 2007 on Vista" rel="bookmark">Installing Office 2007 on Vista</a></h1>
		<div class="categories">
			
				<a href="/category/Windows/">Windows</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>Ok, so I’d promised myself that I would at least give it a month before I’d install Vista on my desktop computer as I simply will not be able to cope with having major problems here. For work purposes I simply have to have a functional desktop computer.</p>
<a id="more"></a>

<p>Oh to heck with that! Having tried Vista on my laptop, I craved for seeing it expose it’s full potential on a more capable machine. I fell into the pressure. I did it. I installed Vista on my desktop.</p>
<p>I’ve blogged the whole process, moving from the usual XP environment to Vista, all the new features, annoyances, problems and so forth. I won’t be blogging about all of it as there’s simply too much, instead I’ll be releasing an article shortly describing the whole process. For now, I’ll stick to a problem I had when I tried to install Office 2007 on the newly installed Vista machine (a problem which Google couldn’t remedy). It was an absolutely fresh install on a formatted drive, all that I’d installed so far were some device drivers. Barring this, Office 2007 should install without a hitch right? Guess not.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_1_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_1_2.jpg" style="max-height: 250px"/></a></div></div>

<p>I started the installation without problems, chose my setup configuration and began the actual installation. After about 6-7 minutes it was at the end of the installation according to the process bar. An hour later it was still at the end of the process bar without anything visibly happening. I checked the task manager, it was constantly using 10-15% CPU. I gave it another hour as I had to go eat anyways.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_2_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>After the second hour it had still not moved anywhere, I’d guess you can call it dead by now. I cancelled the setup (by clicking the red X), but this time it hung again, halfways in the uninstall. Half an hour later I killed the process as nothing was happening.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_3_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_3_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Then this friendly fella popped up, teling me that the uninstallation probably didn’t go as planned, well woope de doo. Clicking “Uninstall using recommended settings” performed the uninstall without problems (I seriously wonder what the “recommended” settings are, seeing as there are no settings in regards of an uninstall).</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_4_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_4_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Reinitiating the Office 2007 install from the DVD resulted in this error - it gets more and more cryptic. I have sucessfully used this DVD to install Vista on Windows XP without problems, so it can’t be the DVD. I then resorted to the true swizz army knife of any software developer - a reboot.</p>
<p>After rebooting I initiated the install again, and what do you know, it actually went all the way through this time without any problems. Finally! Or so I thought at least.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_5_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_5_2.jpg" style="max-height: 250px"/></a></div></div>

<p>“Failed to register a VB Script DLL. Reinstall or run Regsvr32.exe Vbscript.dll to self register. ‘C:Program FilesMicrosoft OfficeOffice12FORMS1033scdrestl.ico’ is not a valid icon file.”</p>
<p>When starting up Outlook, I receive this error message (during the “Setting up accounts” initialization phase). Clicking OK (or the red X) resulted in Outlook closing down and me receiving yet another almost identical message:</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_6_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_6_2.jpg" style="max-height: 250px"/></a></div></div>

<p>“‘C:Program FilesMicrosoft OfficeOffice12FORMS1033scdrestl.ico’ is not a valid icon file.”</p>
<p>More or less the same error message, though this time the title of the dialog was “SetPoint” - the mouse/keyboard driver software for my Logitech diNovo keyboard - what the fudge?</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_7_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_7_2.jpg" style="max-height: 250px"/></a></div></div>

<p>OK, it told me to either “self register” or uninstall. As I have no idea what “self register” incorporates (I tried to regsvr32 Vbscript.dll to no avail, and I hardly think a .ico file can be regsvr32’ed), I went for the uninstall. But this all to familiar dialog box popped up. After about five reboots and several torn images of Bill Gates I realized the I was not going to get this bugger uninstalled (this dialog also appeared through the “Programs and Features” control panel when trying to uninstall from there). So what’s the next step?</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_8_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_8_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Please do not ask me how, I really can’t remember how I dug myself in here, the important thing is that I did. I tried running both .MSI files. I have no idea what they did, the just executed with no GUI and then closed again in about one second. After running these MSI’s, I was suddenly able to run the Office installer again. It acted as though Office wasn’t even installed on my system so I couldn’t uninstall. I decided to just do an install again, hopefully overwriting any buggy files that might have caused the problem.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_5_21.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_5_21.jpg" style="max-height: 250px"/></a></div></div>

<p>Well, the good news is that the install went through problem free. The bad news is that the main problem persisted.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_9_21.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_9_21.jpg" style="max-height: 250px"/></a></div></div>

<p>I dug out the 2KB .ICO file that seemingly was corrupt (and was able to bring down Microsoft Outlook 2007 - talk about David vs. Goliath!). Windows Photo Gallery (the Vista pendant of the XP Preview application) wasn’t able to display the ICO file. As it was able to display all of the other .ICO’s in the same folder I think it’s safe to conclude that the file was somehow damaged.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_10_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_10_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Then I took the damaged SCDRESTL.ICO file and prepended the file name with an underscore. Afterwards I simply took a copy of one of the other working .ICO files (SCDRESTS.ICO) and renamed it SCDRESTL.ICO.</p>
<div class="imgwrapper" style=""><div><a href="/installing-office-2007-on-vista/officeinstall_11_2.jpg" class="fancy"><img src="/installing-office-2007-on-vista/officeinstall_11_2.jpg" style="max-height: 250px"/></a></div></div>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">04</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/running-ie6-and-ie7-at-the-same-time/" title="Running IE6 and IE7 at the Same Time" rel="bookmark">Running IE6 and IE7 at the Same Time</a></h1>
		<div class="categories">
			
				<a href="/category/Tools of the Trade/">Tools of the Trade</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>Ever since IE7 came out developers have had the problem of whether they should upgrade or not. If they chose to upgrade, they wouldn’t be able to test their sites in IE6 any longer as installing IE7 would uninstall IE6. There are 3rd party hacks that allow both versions to be installed at the same time, but they will not simulate a true IE6 / IE7 environment.</p>
<a id="more"></a>

<p>In recognition of this problem, Microsoft has put out a free Virtual PC 2004 (VPC itself has also been made a free download) image containing a pre-activated Windows XP SP2 installation as well as IE6 and the IE7 readiness toolkit. The image will self destruct on the 1st of april 2007, there’ll probably be another solution out by then.</p>
<p><a href="http://blogs.msdn.com/ie/archive/2006/11/30/ie6-and-ie7-running-on-a-single-machine.aspx" target="_blank">Click here to go to the Microsoft IEBlog for further information and download links</a></p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">04</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/setpoint-volume-control-in-vista/" title="SetPoint Volume Control In Vista" rel="bookmark">SetPoint Volume Control In Vista</a></h1>
		<div class="categories">
			
				<a href="/category/Windows/">Windows</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>It seems Logitech has some pretty functional SetPoint drivers out for Vista already (SetPoint is the all-purpose driver software for all their keyboards and mice).</p>
<a id="more"></a>

<p>The ony thing that did not work was the volume control. I could turn it up and down and the visual volume meter would respond (the SetPoint generated one, not the Vista one), but nothing would actually happen.</p>
<p>Fortunately there’s an easy solution.</p>
<div class="imgwrapper" style=""><div><a href="/setpoint-volume-control-in-vista/setpoint_1_2.jpg" class="fancy"><img src="/setpoint-volume-control-in-vista/setpoint_1_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Navigate to “C:Program FilesLogitechSetPoint”. Now make sure that the “SetPoint.exe” process is NOT running - you may have to click Ctrl+Shift+Escape and end the process in the task manager.</p>
<div class="imgwrapper" style=""><div><a href="/setpoint-volume-control-in-vista/setpoint_2_2.jpg" class="fancy"><img src="/setpoint-volume-control-in-vista/setpoint_2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Now rightclick SetPoint.exe and select “Properties”. Navigate to the Compatibility pane and set it to run in compatibility mode as Windows XP (Service Pack 2). After this, double click SetPoint.exe to restart the process. Your volume control should now work!</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Dec</span>
			<span class="day">02</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/running-vista-and-msdnaa-update/" title="Running Vista, MSDNAA Update" rel="bookmark">Running Vista, MSDNAA Update</a></h1>
		<div class="categories">
			
				<a href="/category/Windows/">Windows</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>I am now officially running Vista! Although I have been somewhat skeptical about Vista so far, I must admit that my first impression of Vista is quite positive.</p>
<a id="more"></a>

<p>It seems that most Microsoft affiliated Vista users brag about their high System Rating scores, most of them being in the 4+ area. How about aiming at who can get the lowest score? Well say hello to my laptop:</p>
<div class="imgwrapper" style=""><div><a href="/running-vista-and-msdnaa-update/vista_exp_index_2.jpg" class="fancy"><img src="/running-vista-and-msdnaa-update/vista_exp_index_2.jpg" style="max-height: 250px"/></a></div></div>

<div class="imgwrapper" style=""><div><a href="/running-vista-and-msdnaa-update/vista_exp_index_2.jpg" class="fancy"><img src="/running-vista-and-msdnaa-update/vista_exp_index_2.jpg" style="max-height: 250px"/></a></div></div>

<p>I’ve installed Vista on my Dell Latitude X1 laptop that boasts a puny 1.1Ghz Pentium M CPU and 512MB memory, and the graphics card isn’t even worth mentioning. To my surprise Vista actually seems to run quite well on my laptop. Naturally I’m unable to run the Aero user interface as my laptop is no where capable of that, but even the non-aero user interface looks quite neat. Another plus is that Vista was able to use my sound card, wifi, bluetooth and my laptop specific function keys without me installing any drivers, very nice (in a Borat-ish voice).</p>
<p>The Windows XP user interface never turned me on. In fact, the first thing I do on a new XP installation (after unplugging the network cable) is to revert the user interface back to the good old classic Windows 2000 look, ahhh, the memories. Although Vístas interface looks a lot more professional, one does get the feeling that it really is nothing more than a new user interface running on top of all the old components.</p>
<div class="imgwrapper" style=""><div><a href="/running-vista-and-msdnaa-update/vista_cmd_2.jpg" class="fancy"><img src="/running-vista-and-msdnaa-update/vista_cmd_2.jpg" style="max-height: 250px"/></a></div></div>

<p>For instance, look at this command prompt that I’ve opened. It clearly shows that the Vista interface attempts to put a Vista border around the classic 2k style window, creating some sort of ugly double-border look.</p>
<div class="imgwrapper" style=""><div><a href="/running-vista-and-msdnaa-update/vista_2kstyle_2.jpg" class="fancy"><img src="/running-vista-and-msdnaa-update/vista_2kstyle_2.jpg" style="max-height: 250px"/></a></div></div>

<p>If you switch back to the 2k look you get a bit disappointed. In my opinion the user interface looks very messy, there are no clear lines that indicate the various parts of the window. This isn’t just an issue with the “My Computer” window as indicated in the above picture, but in most Vista windows. Compare it to the Vista look below:</p>
<div class="imgwrapper" style=""><div><a href="/running-vista-and-msdnaa-update/vista_look2_2.jpg" class="fancy"><img src="/running-vista-and-msdnaa-update/vista_look2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Here the “Organize, views, system properties” line is clearly marked using a gradient color, giving a much cleaner look. I know it’s probably blasfemi, but I really wished that they’d spent a bit more time making a nice 2k look as well.</p>
<p>It’s sad that all I’m mentioning here is the user interface, but that really is what counts on a first impression basis. I haven’t used Vista more than about an hour, so I’m going to save any indepth analysis for later on when I know what I’m talking about.</p>
<h2 id="MSDNAA">MSDNAA</h2>
<p>It seems that Vista is already out on MSDNAA in some countries. Though there is no official date we’re hoping to have Vista out on MSDNAA in Denmark sometime in December. Vista Business will be available through MSDNAA, not Ultimate - the Media Center capabilities of Vista Ultimate includes some rather expensive codecs which cannot currently be put onto MSDNAA, I do however hope that it will be possible later on.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>

	<article>
	<div class="datebox">
		<div class="upper">
			<span class="month">Nov</span>
			<span class="day">29</span>
		</div>
		<div class="lower">2006</div>
	</div>

	<div class="title">
		<h1><a href="/multi-monitoring-with-style/" title="Multi Monitoring With Style" rel="bookmark">Multi Monitoring With Style</a></h1>
		<div class="categories">
			
				<a href="/category/Tools of the Trade/">Tools of the Trade</a>
				
			
		</div>
		
		<div class="clear"></div>
	</div>

	<div id="bodywrapper" >

		
		
			<div class="body">
			
				<p>As a developer I strive to increase my productivity. In contrast to most people I know, I’m able to multitask at an unusual level. I often sit at my desktop, working on several projects at the same time (literally), I may also watch multiple movies/tv-series at the same time and so forth.</p>
<a id="more"></a>

<p>So how do we increase productivity? I’ll stick with the hardware/software aspect and ignore the psychological issues (which are not to be neglected, the definitely play a big part as some people just seem to be unable to multitask at any level).</p>
<p>The one thing that has increased my productivity the most was when I bought my my dual-monitor setup (two 20” Dells). Having dual monitors is a world of difference in contrast to having just a single monitor, no matter the size of that single monitor. I’ve had several discussions with friends who would rather have a single 24” monitor instead of two 20” or two 17-19” (there’s no real difference between 17-19” monitors as they all support the same resolution). I would any day choose two low grade 17” monitors over a single 24” monitor, simply because ones productivity is a lot greater when having dual monitors. But why?</p>
<p>The problem with multi tasking on a single monitor is that we tend to - and Windows is built for - have our windows maximized. Maximizing windows is great, it saves us a lot of work, moving windows around so all the open windows fit, resizing them and so forth. By maximizing them we simply have to double click the titlebar and we’re done. But that’s not all good. The problem with maximizing windows is that we can only have a single active window at a time, requiring us to alt-tab around between the windows, or even worse, moving our mouse between the start menu and the actual window content area, wasting a lot of time.</p>
<p>Having multiple monitors enables you to have multiple maximized windows at the same time, as maximizing a window will only maximize it on the monitor it’s currently at. You’d be surprised at how often having just two maximized windows is all you need when working. As a developer we’ll usually have Visual Studio and Internet Explorer running (for web development), or possibly VS + SQL Server Management Studio and so forth. It also gives one a much better perception of the current work task as you can have a lot of arbitrary information lying around on the secondary monitor while working on the primary monitor.</p>
<p>Let me talk a bit about how to optimally place your monitors.</p>
<h2 id="Dual_monitor_setup">Dual monitor setup</h2>
<p>The most intuitive thing to do when setting up a dual monitor setup is to place both monitors on each side of the center point, in effect, placing you directly in between both monitors, having a great view on both of them.</p>
<div class="imgwrapper" style=""><div><a href="/multi-monitoring-with-style/monitorsetup_2.jpg" class="fancy"><img src="/multi-monitoring-with-style/monitorsetup_2.jpg" style="max-height: 250px"/></a></div></div>

<p>This however, is not optimal! You should place yourself directly in front of one of the monitors, the <em>primary</em> one. You will be concentrating your focus on just one of the monitors for 90% of the time, very very rarely will you need to actually look at both monitors at the same time. Placing yourself in the middle will (although you may not be consciously aware of it) cause you to twist your neck to one side continuously. By placing the primary monitor straight ahead of you, you can sit at a normal angle for most of the time, and it feels natural to look over on the other monitor when you actually need it.</p>
<h2 id="Quad_monitor_setup">Quad monitor setup</h2>
<p>What’s the next natural step after dual monitors? Quad monitors of course!</p>
<div class="imgwrapper" style=""><div><a href="/multi-monitoring-with-style/monitor_old_2.jpg" class="fancy"><img src="/multi-monitoring-with-style/monitor_old_2.jpg" style="max-height: 250px"/></a></div></div>

<p>This was my second setup, after my dual monitor setup. Let me give you a warning right now and here, you should <em>not</em> get a setup like this unless you have a really explicit need for quad monitors. I loved this setup while I was setting it up, I loved it for about a week (simply because I had to, after all it wasn’t really that cheap). But the fact is that it’s utterly useless. Again, you’ll have to position the primary monitor right in front of you, but on most quad monitor stands, it’s not really possible to customize the setup very much. Also the lower monitors will simply be too low for you to look at them naturally (and the top ones will be too high), so this setup will cause you to constantly sit in a bad position, not really having any monitors feeling natural to look at.</p>
<h2 id="Triple_monitor_setups">Triple monitor setups</h2>
<p>Before I had my quad setup, I had three of those 20” Dell’s. That was actually a quite good setup, and that’s what I’m going to describe here. Unfortunately you’ll have to do with a picture of my current setup (two 20”‘s with a center 30”) as I can’t find any pictures of my trip-20”‘s setup.</p>
<div class="imgwrapper" style=""><div><a href="/multi-monitoring-with-style/monitor_current1_2.jpg" class="fancy"><img src="/multi-monitoring-with-style/monitor_current1_2.jpg" style="max-height: 250px"/></a></div></div>

<p>Having three monitors is a great solution if you really need a lot of monitor real estate. The obvious advantage is that there’s a center monitor that will quite naturally become the primary monitor. The two side/satellite monitors will become secondary monitors where you’ll keep all the arbitrary info while working. Again, the most important factor here is that you’ll be able to work on your primary monitor while looking at a an angle that feels natural.</p>
<h2 id="Required_hardware">Required hardware</h2>
<p>Most people think it requires a lot of expensive hardware to run multiple monitors - that’s a myth! Most graphics cards today actually come with dual monitor outputs. It doesn’t matter if ones VGA and the other’s a DVI output, as long as you’re able to connect your monitors, it’ll work. If you’re going to buy a new graphics card, please do yourself a favor and get one with DVI outputs as it delivers a better picture on TFT’s.</p>
<p>As for monitors, you really should get yourself monitors that support the same height resolution. It’s a pain when you can’t move your mouse clearly from one monitor to the other since the resolution doesn’t allow you to do so.</p>
<h2 id="Software">Software</h2>
<p>Windows is great at automatically setting up your x-monitor system. It’ll automatically recognize the monitors and stretch your desktop across all monitors. You don’t need any 3rd party software to run multiple monitors.</p>
<div class="imgwrapper" style=""><div><a href="/multi-monitoring-with-style/monitorproperties_2.jpg" class="fancy"><img src="/multi-monitoring-with-style/monitorproperties_2.jpg" style="max-height: 250px"/></a></div></div>

<p>In the usual display properties control panel, you’ll be able to arrange your monitors and setup how they should behave when you move your mouse from one monitor to the other. If the physical left monitor appears to be on the right side of your center monitor, simply switch them around here.</p>
<p>You should note that there essentially three different multi monitor modes (I’ll be using nVidia terms as that’s what I’m using).</p>
<ul>
<li>DualView makes each monitor act as an individual monitor, that means you’ll be able to maximize windows on that monitor and make it behave as a stand alone monitor.</li>
<li>Clone does what the name implies, it simply clones the contents of your primary monitor onto your secondary monitor.</li>
<li>Horizontal span will combine all of your monitors to one giant monitor. It’s highly unusable as maximizing a window will cause it to be maximized across all monitors - which isn’t really that useful as you’ll probably have some space between the displays, causing an interruption in the middle of your favorite application.</li>
</ul>
<h2 id="UltraMon">UltraMon</h2>
<p>While you don’t <em>need</em> any 3rd party software to run multiple monitors, you’re going to need some to do it effectively! When you connect multiple monitors to Windows, it’ll only show your taskbar on the primary monitor, and it’s a pain in the ass to move your mouse all the way from the secondary monitor to the primary monitor, just to switch applications. UltraMon will put a taskbar on all of your monitors. The UltraMon taskbar works just like the Windows one, it’ll only show the windows that are currently on that particular monitor. Also UltraMon enables you to setup keyboard shortcuts for moving a window from one monitor to another, I use Ctrl+Alt+Shift+Left/Right for moving a window to the previous/next monitor. UltraMon does a lot more, but these are the most important features. Oh yeah, it also enables you to make multi monitor wallpapers:</p>
<div class="imgwrapper" style=""><div><a href="/multi-monitoring-with-style/monitor_current2_2.jpg" class="fancy"><img src="/multi-monitoring-with-style/monitor_current2_2.jpg" style="max-height: 250px"/></a></div></div>

<p>UltraMon is a bargain at $39 for a non time limited version. <a href="http://www.realtimesoft.com/ultramon/" target="_blank">Click here to go the the UltraMon website</a>.</p>
<p>There’s a free alternative to UltraMon, MultiMon. While in my experience MultiMon did not work as stable and feature complete as UltraMon, it’s great if you don’t wanna spend the $39. <a href="http://www.mediachance.com/free/multimon.htm" target="_blank">Click here to go the the MultiMon website</a>.</p>
<h2 id="allSnap">allSnap</h2>
<p>allSnap makes all your window snap to the edges of your monitor(s), it may also snap to other windows, it can be customized to any way you like. allSnap is great when you have to have several windows open on one monitor, it makes it a lot quicker for you to resize the windows so you utilize your full monitor area.<a href="http://www.cs.utoronto.ca/~iheckman/allsnap/" target="_blank">Click here to go the the allSnap website</a>.</p>


				<div style="clear: both"></div>

				

			</div>

		

		

	</div>
</article>


<div class="paging">
	<a href="/page/23/"><div class="past">« Past</div></a>
	<a href="/page/21/"><div class="future">Future »</div></a>
	<div class="clear"></div>
</div>

				</div>
			</div>

			<div id="asides">
				<div class="categories aside">
					<span class="sectiontitle">CATEGORIES</span>
					<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/category/.NET/">.NET</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/AS/Flex/Flash/">AS/Flex/Flash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Amazon Web Services/">Amazon Web Services</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Computer Science/">Computer Science</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Conferences and Presenting/">Conferences and Presenting</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/IIS/">IIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Life/">Life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Miscellaneous/">Miscellaneous</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Performance/">Performance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Poker/">Poker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server/">SQL Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Community/">SQL Server - Community</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Data Types/">SQL Server - Data Types</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Internals/">SQL Server - Internals</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Optimization/">SQL Server - Optimization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - OrcaMDF/">SQL Server - OrcaMDF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/SQL Server - Tricks/">SQL Server - Tricks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Testing/">Testing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Tools of the Trade/">Tools of the Trade</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Umbraco/">Umbraco</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Visual Studio/">Visual Studio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Web/">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Windbg/">Windbg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/category/Windows/">Windows</a></li></ul>

					
				</div>

				<div class="archive aside">
					<span class="sectiontitle">ARCHIVE</span>
					<ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archive/2014">2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2013">2013</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2012">2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2011">2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2010">2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2009">2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2008">2008</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2007">2007</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archive/2006">2006</a></li></ul>
				</div>
			</div>

			<div class="clear"></div>
		</div>
		
		<footer>
			<div class="wrapper">Copyright &copy; 2014 Mark S. Rasmussen</div>
		</footer>

		<script type="text/javascript">
			$(function () {
				// Show mobile menu
				$("li.navicon").click(function () {
					if ($("header ul.mobile a").length == 0) {
						// Pages
						$mobilePages = $("div#naviconcontent ul.pages");
						$("header nav ul.normal > li").not(".navicon").each(function (i, el) {
							$mobilePages.append($(el).clone());
						});

						// Categories
						$mobileCategories = $("div#naviconcontent ul.categories");
						$("div#asides div.categories > ul > li").each(function (i, el) {
							$mobileCategories.append($(el).clone());
						});

						// Archive
						$mobileArchive = $("div#naviconcontent ul.archive");
						$("div#asides div.archive > ul > li").each(function (i, el) {
							$mobileArchive.append($(el).clone());
						});
					};

					$("header ul.mobile").toggle();
				});

				// Fancybox setup
				$("a.fancy").fancybox({
					hideOnContentClick: true,
					overlayShow: true
				});
			});
		</script>
	</body>
</html>